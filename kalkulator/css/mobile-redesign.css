/**
 * MOBILE REDESIGN CSS
 * Professional mobile-first stylesheet for TOP-INSTAL Heat Pump Calculator
 *
 * Design philosophy: Hetzner-style minimalism, HVAC precision, mobile-first
 * Version: 1.0
 * Date: 16.12.2025
 */

/* =============================================================================
   1. MOBILE CSS VARIABLES
   ============================================================================= */

@media (max-width: 767px) {
  :root {
    /* Page rhythm - STRICT 8PX GRID ENFORCEMENT */
    --page-pad: 0px; /* Edge-to-edge (justified for mobile) */
    --content-pad: 16px; /* Standard breathing from edges */

    /* Spacing Mobile - STRICT 8PX GRID */
    --spacing-xs: 8px; /* Tight gaps, compact lists */
    --spacing-sm: 12px; /* Comfortable gaps, related items */
    --spacing-md: 16px; /* Standard padding, breathing space */
    --spacing-lg: 24px; /* Section spacing, major groups */
    --spacing-xl: 32px; /* Large breathing, section breaks */
    --spacing-2xl: 48px; /* Hero sections, dramatic spacing */

    /* Component spacing (semantic names) */
    --space-section: 32px; /* Between major sections */
    --space-section-tight: 24px; /* Hero → first section */
    --space-component: 24px; /* Between form fields */
    --space-related: 12px; /* Between related items */
    --space-tight: 8px; /* Label → input, tight relationships */

    /* Ensure core colors exist even if mobile rules from main.css are removed */
    --color-accent: #d4a574;
    --color-selected: #d4a574;
    --color-selected-bg: #f0ddc4; /* Darker for better contrast (was #f5e6d3) */
    --color-border: #e0e0e0;
    --color-text-primary: #1a1a1a;
    --color-text-secondary: #374151;
    --color-bg-subtle: #fafafa; /* For help-boxes, subtle backgrounds */

    /* Gold Accent Colors - Premium HVAC Design */
    --color-gold: #d4a574;
    --color-gold-dark: #8b6914;
    --color-gold-light: #f0ddc4; /* Updated to match selected-bg */
    --color-gold-border: #d4a574;

    /* Typography Mobile Scale */
    --font-size-xs: 12px;
    --font-size-sm: 14px;
    --font-size-base: 16px;
    --font-size-md: 18px;
    --font-size-lg: 20px;
    --font-size-xl: 24px;
    --font-size-2xl: 28px;
    --font-size-3xl: 32px;

    /* Touch Targets - OPTIMIZED (not over-compliant) */
    --touch-min: 44px; /* WCAG AA minimum */
    --touch-optimal: 52px; /* Secondary actions */
    --touch-primary: 56px; /* Primary actions (not 58px) */

    /* Shadows Mobile (subtle, engineering-grade) */
    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.06);
    --shadow-md: 0 2px 4px rgba(0, 0, 0, 0.08);
    --shadow-lg: 0 4px 8px rgba(0, 0, 0, 0.1);
    --shadow-selected: 0 0 0 4px rgba(212, 165, 116, 0.16); /* Enhanced from 3px/0.08 */
    --shadow-sticky: 0 4px 12px rgba(0, 0, 0, 0.12);
  }
}

/* =============================================================================
   2. MOBILE RESET & BASE
   ============================================================================= */

@media (max-width: 767px) {
  /* Prevent iOS zoom on input focus */
  input[type="text"],
  input[type="email"],
  input[type="tel"],
  input[type="number"],
  select,
  textarea {
    font-size: 16px !important;
  }

  /* Touch-action optimization */
  button,
  a,
  .building-type-card,
  .option-card,
  .product-card {
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }

  /* Smooth scrolling */
  html {
    scroll-behavior: smooth;
    scroll-padding-top: 60px;
    -webkit-overflow-scrolling: touch;
  }

  /* Body adjustments */
  body {
    font-size: var(--font-size-base);
    line-height: 1.6;
    text-size-adjust: 100%; /* Standard property - prevents iOS zoom */
  }

  /* Calculator wrapper full-width on mobile */
  #top-instal-calc.wrapper {
    padding: 0;
    width: 100% !important;
    max-width: 100% !important;
  }
}

/* =============================================================================
   2A. ANTI-OVERFLOW LAYER (CRITICAL)
   Based on dom_overflow_scan results: 50 offenders on 390px
   Goal: 0 offenders on 390px, 360px, 320px
   ============================================================================= */

@media (max-width: 767px) {
  /* Force box-sizing for all form components */
  .section,
  .section *,
  .formularz,
  .formularz *,
  .form-card,
  .form-card *,
  .form-field,
  .form-field *,
  .help-box,
  .help-box * {
    box-sizing: border-box !important;
  }

  /* A) Section container – source: width 1300px causing +532px overflow on 768px */
  .section {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: var(--page-pad) !important;
    padding-right: var(--page-pad) !important;
  }

  /* B) Form containers – source: .formularz-z-mapa (1148px), .formularz (564px computed) */
  .formularz-z-mapa {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    flex-direction: column !important;
    gap: var(--spacing-md) !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  .formularz {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  /* C) Form row mosaic – desktop grid 1fr 1fr, mobile column */
  .form-row-mosaic {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    display: flex !important;
    flex-direction: column !important;
    gap: var(--spacing-md) !important;
    margin: 0 0 var(--spacing-lg) 0 !important;
  }

  /* D) Form card – source: padding 36px 64px 36px 96px causes asymmetry */
  .form-card {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    padding: 20px var(--content-pad) !important;
    margin: 0 !important;
    border-radius: 0 !important; /* Flat design - no radius */
    border: none !important; /* No border */
    box-shadow: none !important; /* No shadow */
    background: transparent !important; /* Merged with section */
  }

  /* E) Form field – source: 530px fixed width (7× in main.css) */
  .form-field {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    margin: 0 0 var(--spacing-lg) 0 !important;
    padding: 0 !important;
  }

  /* F) Form field item – source: 530px inherited */
  .form-field-item {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  .form-row-mosaic > .form-field:first-of-type .form-field-item:first-of-type,
  .form-card > .form-field:first-of-type .form-field-item:first-of-type {
    margin-top: 20px !important;
  }

  /* G) Form labels – source: 530px inherited */
  .form-label {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    display: block !important;
    margin: 0 0 2px 0 !important; /* UJEDNOLICONE: 2px dół (minimalny odstęp pod labelem) */
    padding: 0 !important;
  }

  .form-field-item.has-number-value
    input[type="number"]:not(:focus):not(:disabled) {
    border-color: var(
      --color-gold,
      #d4a574
    ) !important; /* Złoty zamiast szarego */
    border-width: 2px !important;
    background: var(
      --color-selected-bg,
      #f5e6d3
    ) !important; /* Złote tło zamiast szarego */
    box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.08) !important; /* Subtelny glow */
    box-shadow: none !important;
  }

  /* H) Building type cards container – source: 530px grid container */
  .building-type-cards {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 12px !important;
    margin: 16px 0 0 0 !important;
    padding: 0 !important;
  }

  /* I) Construction year wrapper – source: 530px select wrapper */
  .construction-year-wrapper {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  /* J) Form select – source: 530px computed width */
  select,
  .form-select,
  #construction_year {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    margin: 0 !important;
  }

  /* K) Radio group – source: 530px flex column container */
  .form-field__radio-group {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  /* L) Radio labels – source: 530px full-width labels */
  .form-field__radio-label {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    margin: 0 !important;
  }

  /* M) Help boxes – source: 530px computed in mosaic layout */
  .help-box {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    margin-left: 0 !important; /* ✅ FIXED: Usuń przesunięcie w prawo */
    margin-right: 0 !important;
    margin-top: 6px !important; /* UJEDNOLICONE: 6px góra */
    margin-bottom: 0px !important; /* UJEDNOLICONE: 0px dół */
    padding: 20px var(--content-pad) !important; /* Consistent with main help-box styles */
    background: #f5f5f5 !important; /* Delikatnie ciemniejsze tło */
    border: none !important; /* No border - flat design */
    border-radius: 2px !important; /* 2px radius */
  }

  /* Help-box w form-row-mosaic - pełna szerokość bez przesunięcia */
  .form-row-mosaic .help-box {
    width: 100% !important;
    max-width: 100% !important;
    margin-left: 0 !important; /* ✅ FIXED: Usuń margin-left z desktop (var(--spacing-xl)) */
    margin-right: 0 !important;
    padding-left: var(--content-pad) !important;
    padding-right: var(--content-pad) !important;
  }

  /* N) Help box content (prevent child overflow) */
  .help-box h4,
  .help-box h3,
  .help-box p,
  .help-box ul,
  .help-box ol {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
  }

  .help-box img,
  .help-box .zone-map {
    width: 100% !important;
    max-width: 100% !important;
    height: auto !important;
    display: block !important;
  }

  /* O) Input fields – ensure 100% width */
  input[type="text"],
  input[type="email"],
  input[type="tel"],
  input[type="number"],
  textarea {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    margin: 0 !important;
  }

  /* P) Textarea specific */
  textarea {
    resize: vertical !important;
  }

  /* Q) Prevent any fixed-width inherited styles */
  .section .form-field,
  .section .form-field-item,
  .section input,
  .section select,
  .section textarea {
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* R) Results wrapper – source: width 1300px in main.css:2877 */
  .results-wrapper {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    padding: 0 var(--content-pad) !important;
  }

  /* S) Custom sliders – source: width 530px (small), 745px (large) */
  .custom-slider-small,
  .custom-slider-large,
  .slider-container {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* T) Brand content in GDPR – source: overflow +24px on 390px */
  .brand-content {
    width: 100% !important;
    max-width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    margin-top: var(--spacing-2xl) !important; /* 48px - mniejszy niż desktop */
    padding: var(--spacing-lg) var(--content-pad) !important; /* 24px vertical, 16px horizontal */
    padding-top: var(--spacing-xl) !important; /* 32px góra */
    display: flex !important;
    flex-direction: column !important; /* Kolumna na mobile */
    align-items: center !important;
    justify-content: center !important;
    gap: var(--spacing-md) !important; /* 16px - mniejszy gap niż desktop */
    border-top: var(--border-width) solid var(--color-border-light) !important;
    border-radius: 0 !important; /* Flat design na mobile */
    background: #ffffff !important;
  }

  /* Brand logo - mniejszy na mobile */
  .brand-content .brand-logo {
    max-width: 120px !important; /* Mniejszy niż desktop (150px) */
    height: auto !important;
  }

  /* Brand text - dostosowany do mobile */
  .brand-content .brand-text {
    text-align: center !important;
    width: 100% !important;
  }

  .brand-content .brand-text p {
    font-size: var(--font-size-sm) !important; /* 14px - mniejszy niż desktop */
    line-height: 1.5 !important;
    margin: 0 !important;
  }

  .brand-content .brand-text p:first-child {
    font-size: var(
      --font-size-base
    ) !important; /* 16px - mniejszy niż desktop */
    font-weight: 700 !important;
    margin-bottom: var(--spacing-xs) !important; /* 8px odstęp */
  }

  /* U) Button row – ensure full width */
  .btn-row {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important;
  }

  /* V) Flex/Grid children min-width fix (CSS spec: flex children can inherit min-width > 0) */
  .formularz-z-mapa > *,
  .form-row-mosaic > *,
  .form-field > *,
  .form-field-item > *,
  .form-field__radio-group > * {
    min-width: 0 !important;
  }
}

/* =============================================================================
   2B. MOBILE VERTICAL SPACING RESET (CRITICAL)
   Zeruje desktop marginesy - mobile używa własnego systemu
   ============================================================================= */

@media (max-width: 767px) {
  /* A) Reset ALL vertical margins from desktop */
  .section,
  .section > *,
  .form-card,
  .form-card > *,
  .form-field,
  .form-field > *,
  .form-field-item,
  .form-field-item > *,
  .form-label,
  .form-row-mosaic,
  .form-row-mosaic > *,
  .help-box,
  .building-type-cards,
  .yes-no-cards,
  .option-cards,
  .btn-row {
    margin-top: 0 !important;
    margin-bottom: 0 !important;
  }

  /* B) Apply ONLY bottom margins where needed (mobile rhythm) */
  .section {
    margin-bottom: var(--space-section) !important; /* 32px */
  }

  .form-card {
    margin-bottom: var(--space-section) !important; /* 32px */
  }

  .form-field {
    margin-bottom: var(--space-component) !important; /* 24px */
  }

  .form-field-item {
    margin-bottom: var(--spacing-lg) !important; /* 24px */
  }

  .form-label {
    margin-bottom: var(--space-component) !important; /* 24px - była 30px */
  }

  .help-box {
    margin-bottom: var(--spacing-md) !important; /* 16px */
  }

  .building-type-cards,
  .yes-no-cards,
  .option-cards {
    margin-bottom: var(--spacing-lg) !important; /* 24px */
  }

  /* C) Use gap for containers instead of child margins */
  .form-row-mosaic {
    gap: var(--spacing-md) !important; /* 16px */
    margin-bottom: var(--spacing-xl) !important; /* 32px */
  }

  .building-type-cards {
    gap: var(--spacing-md) !important; /* 16px */
  }

  .yes-no-cards {
    gap: 14px !important;
  }

  .option-cards {
    gap: 14px !important;
  }

  .btn-row {
    gap: 14px !important;
    margin-top: var(
      --spacing-xl
    ) !important; /* 32px - tylko top dla separacji */
  }
}

/* =============================================================================
   3. MOBILE HERO SECTION — COMPRESSED FOR FASTER CONTENT ACCESS
   ============================================================================= */

@media (max-width: 767px) {
  .hero {
    padding: clamp(24px, 5vw, 40px) var(--page-pad); /* Reduced from 32px-60px */
    min-height: 30vh; /* Reduced from 40vh */
    max-height: 40vh; /* Reduced from 50vh */
    margin-bottom: var(--space-section-tight); /* 24px → first section */
  }

  .hero-media::after {
    background: linear-gradient(
      135deg,
      rgba(30, 25, 20, 0.85) 0%,
      rgba(45, 38, 30, 0.75) 100%
    );
  }

  .hero-inner {
    gap: var(--spacing-sm); /* 12px for tight hero content */
  }

  .hero-pill {
    padding: 6px 14px; /* On grid: 6px vertical (exception), 14px horizontal */
    font-size: 11px;
  }

  .hero h1 {
    font-size: clamp(24px, 7vw, 32px); /* Reduced max from 36px */
    line-height: 1.2;
    margin: 0;
  }

  .hero-lead {
    font-size: clamp(14px, 2vw, 16px);
    line-height: 1.6;
    max-width: 100%;
    margin: 0;
    padding: 0;
  }

  .hero .container {
    max-width: 100%;
    width: 100%;
    padding: 0 var(--content-pad); /* 16px breathing */
    box-sizing: border-box;
  }
}

/* =============================================================================
   4. MOBILE PROGRESS BAR — COMPRESSED FOR MINIMAL STICKY HEIGHT
   ============================================================================= */

@media (max-width: 767px) {
  /* Progress Bar Container - CSS sticky (optymalizacja mobile) */
  /* ZACHOWUJEMY position: sticky dla mobile (lepsze niż fixed), ale resztę ujednolicamy z desktop */
  .progress-bar-container {
    position: sticky !important;
    top: var(--header-height, 0) !important;
    z-index: 50 !important;
    padding: var(--spacing-sm) var(--spacing-xl) var(--spacing-xs) !important; /* Jak desktop: 12px 32px 8px */
    background: var(--color-surface, #fff) !important;
    border-bottom: var(--border-width, 1px) solid var(--color-border, #e0e0e0) !important;
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    box-shadow: var(
      --shadow-md,
      0 2px 4px rgba(0, 0, 0, 0.08)
    ) !important; /* Jak desktop */
  }

  /* NADPISZ desktop .sticky (z main.css) na mobile - wyższa specyficzność */
  /* ZACHOWUJEMY position: sticky dla mobile (optymalizacja) */
  .progress-bar-container.sticky {
    /* FIX: w praktyce sticky potrafi być blokowane przez rodziców (overflow/transform).
       Gdy JS doda .sticky — wymuś fixed, żeby progress zawsze był "przyklejony". */
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    z-index: 9999 !important;
    padding: var(--spacing-sm) var(--spacing-xl) var(--spacing-xs) !important; /* Jak desktop */
    margin: 0 !important;
    max-width: 100% !important;
    animation: none !important; /* Wyłącz desktop animation - optymalizacja mobile */
    box-shadow: var(
      --shadow-md,
      0 2px 4px rgba(0, 0, 0, 0.08)
    ) !important; /* Jak desktop */
  }

  /* Wyśrodkuj zawartość w sticky container - jak desktop */
  .progress-bar-container.sticky .hp-progress,
  .progress-bar-container.sticky .hp-progress-info {
    max-width: var(--container-md, 1148px) !important;
    margin: 0 auto !important;
  }

  /* Jeśli JS doda .hidden - ukryj przez opacity, nie przez transform */
  .progress-bar-container.hidden {
    opacity: 0 !important;
    pointer-events: none !important;
  }

  /* Progress track - jak desktop */
  .form-progress {
    height: 4px !important;
    margin: var(--spacing-lg, 24px) 0 0 0 !important; /* Jak desktop (z main.css:1322) */
    border-radius: var(--radius-sm) !important;
    overflow: hidden;
    background: var(--color-border, #e5e7eb) !important;
  }

  /* .hp-progress - jak desktop (ma inny margin niż .form-progress) */
  .hp-progress {
    height: 4px !important;
    margin-bottom: 8px !important; /* Jak desktop (z main.css:3936) */
    border-radius: var(--radius-sm) !important;
    overflow: hidden;
    background: var(--color-border, #e5e7eb) !important;
  }

  .form-progress-fill {
    height: 100%;
    border-radius: var(--radius-sm) !important;
    transition: width var(--transition-slow, 0.4s) cubic-bezier(0.4, 0, 0.2, 1) !important;
    background: var(
      --color-accent-gradient,
      linear-gradient(135deg, #d4a574, #b8976a)
    ) !important;
    box-shadow: var(
      --shadow-md,
      0 2px 4px rgba(0, 0, 0, 0.08)
    ) !important; /* Jak desktop */
  }

  /* Progress info row - UJEDNOLICONE z desktop */
  .progress-info-row {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    flex-wrap: wrap !important; /* FIX: brak nachodzenia tekstów */
    margin: 4px 0 48px 0 !important; /* Jak desktop (z main.css:1392) - był: 4px 0 0 0 */
    gap: var(--spacing-sm, 12px) !important;
  }

  /* .hp-progress-info - UJEDNOLICONE z desktop */
  .hp-progress-info {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    flex-wrap: wrap !important; /* FIX: brak nachodzenia tekstów */
    margin-bottom: 36px !important; /* Jak desktop (z main.css:3942) */
    gap: var(--spacing-sm, 12px) !important;
  }

  .form-progress-percentage,
  .hp-progress-info .form-progress-percentage {
    font-weight: 600 !important;
    color: var(--color-text-muted, #374151) !important;
    font-feature-settings: "tnum" !important;
    position: static !important; /* FIX: nie absolutnie na środku (powodowało overlap) */
    transform: none !important;
    margin-left: auto !important;
  }

  /* Progress label - UJEDNOLICONE z desktop (uppercase, left align, oryginalne treści) */
  .form-progress-label,
  .hp-progress-info .form-progress-label {
    text-align: left !important; /* Jak desktop - był: right */
    color: var(--color-text-muted, #6b7280) !important;
    font-size: 0.95rem !important; /* Jak desktop (z main.css:3948) - był: 13px */
    font-weight: 600 !important; /* Jak desktop */
    text-transform: uppercase !important; /* Jak desktop - był: none */
    letter-spacing: 0.3px !important; /* Jak desktop */
    opacity: 0.85 !important; /* Jak desktop (z main.css:3949) */
    max-width: 100% !important; /* Usunięte ograniczenie 60% */
    overflow: visible !important; /* Usunięte overflow hidden */
    text-overflow: clip !important;
    white-space: normal !important; /* Pozwól na zawijanie jak desktop */
    margin: 0 !important;
    padding-left: 0 !important; /* Jak desktop */
    position: relative !important; /* Jak desktop */
  }

  /* Placeholder — JS używa go przy sticky; NIE blokuj na mobile */
  .progress-sticky-placeholder {
    height: 72px !important; /* zapas na sticky progress */
    display: none; /* JS może ustawić display */
  }
}

/* =============================================================================
   5. MOBILE SECTION LAYOUT — STRICT VERTICAL RHYTHM
   ============================================================================= */

@media (max-width: 767px) {
  .section {
    width: 100%;
    max-width: 100%;
    margin: 0 auto var(--space-section); /* 32px between sections (was 28px) */
    padding: var(--spacing-lg) 0 !important; /* 24px vertical rhythm (was 28px) */
    border-radius: 0; /* Full bleed on mobile */
  }

  .section.active {
    animation: sectionFadeIn 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }

  @keyframes sectionFadeIn {
    from {
      opacity: 0;
      transform: translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Form rows - stack vertically with consistent spacing (flat design) */
  .form-row-mosaic {
    width: 100% !important;
    max-width: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    gap: var(
      --spacing-md
    ) !important; /* 16px between help-box and form-field */
    margin-left: 0 !important;
    margin-right: 0 !important;
    margin-bottom: var(--spacing-xl) !important; /* 32px bottom (was 28px) */
    padding: 0 var(--content-pad) !important; /* 16px horizontal breathing */
    box-sizing: border-box !important;
    border: none !important; /* No border */
    box-shadow: none !important; /* No shadow */
    background: transparent !important; /* Merged with section */
  }

  /* Form cards - FLAT DESIGN (no border, no shadow, merged with background) */
  .form-card {
    width: 100% !important;
    max-width: 100% !important;
    padding: var(--spacing-lg) var(--content-pad) !important; /* 24px vertical, 16px horizontal */
    margin-left: 0 !important;
    margin-right: 0 !important;
    margin-bottom: var(--space-section) !important; /* 32px (was 28px) */
    border-radius: 0 !important; /* No radius - flat design */
    border: none !important; /* No border */
    background: transparent !important; /* Merged with section background */
    box-shadow: none !important; /* No shadow - flat design */
    box-sizing: border-box !important;
  }

  /* Help-box ordering: ensure help-box → form-field → help-box → form-field pattern */
  .form-row-mosaic .help-box {
    order: 1 !important; /* Help-box first */
    margin-left: 0 !important; /* ✅ FIXED: Pełna szerokość bez przesunięcia */
    margin-right: 0 !important;
    margin-top: 6px !important; /* UJEDNOLICONE: 6px góra */
    margin-bottom: 0px !important; /* UJEDNOLICONE: 0px dół */
    width: 100% !important;
    max-width: 100% !important;
    padding-left: var(--content-pad) !important;
    padding-right: var(--content-pad) !important;
  }

  .form-row-mosaic .form-field {
    order: 2 !important; /* Form-field after help-box */
    margin-bottom: 0 !important;
  }

  /* FIX: elementy typu .form-field-item (np. suwak wall_size) nie są .form-field — bez tego wpadają na górę */
  .form-row-mosaic > .form-field-item,
  .form-row-mosaic > .form-field-item--subsequent {
    order: 3 !important;
  }

  /* Prevent 2 help-boxes in a row - hide second consecutive help-box */
  .form-row-mosaic .help-box + .help-box {
    display: none !important; /* Hide if 2 help-boxes consecutive */
  }

  /* =============================================================================
     DETAILED MODE TOGGLE - Mobile Styles (tryb uproszczony/szczegółowy)
     ============================================================================= */

  /* Detailed mode toggle - widoczny i funkcjonalny na mobile */
  .detailed-mode-toggle {
    display: flex !important;
    align-items: flex-start !important;
    gap: 12px !important;
    cursor: pointer !important;
    margin-bottom: 16px !important;
    padding: 12px !important;
    border-radius: 8px !important;
    background: #ffffff !important;
    border: 1px solid #e5e7eb !important;
    transition: background-color 0.2s ease, border-color 0.2s ease !important;
    width: 100% !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }

  /* Gdy toggle jest wstawiony jako „5. opcja” wewnątrz .option-cards, wymuś pełną szerokość */
  .option-cards .detailed-mode-toggle {
    flex: 1 1 100% !important;
    width: 100% !important;
    max-width: 100% !important;
    margin-top: 8px !important;
  }

  .detailed-mode-toggle:active {
    background-color: #f9fafb !important;
    border-color: #d4a574 !important;
  }

  /* Detailed mode checkbox - większy na mobile dla lepszego UX touch */
  .detailed-mode-checkbox {
    width: 24px !important; /* Zwiększone z 20px dla lepszego touch target */
    height: 24px !important; /* Zwiększone z 20px dla lepszego touch target */
    min-width: 24px !important;
    min-height: 24px !important;
    cursor: pointer !important;
    margin-top: 2px !important;
    flex-shrink: 0 !important;
    appearance: none !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    border: 2px solid #d1d5db !important;
    border-radius: 4px !important;
    background-color: #ffffff !important;
    position: relative !important;
    transition: all 0.2s ease !important;
    touch-action: manipulation !important;
  }

  .detailed-mode-checkbox:checked {
    background-color: #d4a574 !important;
    border-color: #d4a574 !important;
  }

  .detailed-mode-checkbox:checked::after {
    content: "" !important;
    position: absolute !important;
    left: 7px !important; /* Dostosowane dla większego checkboxa */
    top: 3px !important; /* Dostosowane dla większego checkboxa */
    width: 5px !important;
    height: 10px !important;
    border: solid white !important;
    border-width: 0 2px 2px 0 !important;
    transform: rotate(45deg) !important;
  }

  .detailed-mode-checkbox:focus {
    outline: none !important;
    box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.2) !important;
    border-color: #d4a574 !important;
  }

  /* Detailed mode label - czytelny na mobile */
  .detailed-mode-label {
    display: flex !important;
    flex-direction: column !important;
    gap: 4px !important;
    flex: 1 !important;
    min-width: 0 !important;
  }

  .detailed-mode-label strong {
    font-weight: 600 !important;
    color: #1a1a1a !important;
    font-size: 15px !important; /* Dostosowane dla mobile */
    line-height: 1.4 !important;
  }

  .detailed-mode-label small {
    display: block !important;
    color: #6b7280 !important;
    font-weight: normal !important;
    font-size: 13px !important; /* Dostosowane dla mobile */
    line-height: 1.5 !important;
  }

  /* Pola uproszczone i szczegółowe - widoczność na mobile */
  #walls-simplified-field,
  #roof-simplified-field,
  #floor-simplified-field,
  #walls-detailed-field,
  #roof-detailed-field,
  #floor-detailed-field {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }

  /* Upewnij się, że klasa .hidden działa poprawnie na mobile */
  .hidden,
  #walls-detailed-field.hidden,
  #roof-detailed-field.hidden,
  #floor-detailed-field.hidden,
  #walls-simplified-field.hidden,
  #roof-simplified-field.hidden,
  #floor-simplified-field.hidden {
    display: none !important;
    visibility: hidden !important;
  }

  /* Pola szczegółowe widoczne (gdy nie ma klasy hidden) */
  #walls-detailed-field:not(.hidden),
  #roof-detailed-field:not(.hidden),
  #floor-detailed-field:not(.hidden) {
    display: block !important;
    visibility: visible !important;
  }

  /* Pola uproszczone widoczne (gdy nie ma klasy hidden) */
  #walls-simplified-field:not(.hidden),
  #roof-simplified-field:not(.hidden),
  #floor-simplified-field:not(.hidden) {
    display: block !important;
    visibility: visible !important;
  }

  /* Zagnieżdżone pola szczegółowe (np. externalIsolationFields) */
  #externalIsolationFields,
  #topIsolationFields,
  #bottomIsolationFields {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }

  #externalIsolationFields.hidden,
  #topIsolationFields.hidden,
  #bottomIsolationFields.hidden {
    display: none !important;
    visibility: hidden !important;
  }

  #externalIsolationFields:not(.hidden),
  #topIsolationFields:not(.hidden),
  #bottomIsolationFields:not(.hidden) {
    display: block !important;
    visibility: visible !important;
  }

  /* Separatory między sekcjami izolacji - widoczne na mobile */
  .section[data-tab="4"] hr {
    display: block !important;
    visibility: visible !important;
    margin: 24px 0 !important; /* Zmniejszone z 32px na mobile */
    border: none !important;
    border-top: 1px solid #e5e7eb !important;
    width: 100% !important;
    max-width: 100% !important;
  }

  /* Option cards w trybie uproszczonym - lepsze spacing na mobile */
  #walls-simplified-field .option-cards,
  #roof-simplified-field .option-cards,
  #floor-simplified-field .option-cards {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important;
    padding: 8px !important;
    background: #f9fafb !important;
    border: 1px solid #e5e7eb !important;
    border-radius: 12px !important;
  }

  #walls-simplified-field .option-cards .option-card,
  #roof-simplified-field .option-cards .option-card,
  #floor-simplified-field .option-cards .option-card {
    width: 100% !important;
    min-height: 64px !important; /* Większe na mobile dla lepszego touch */
    padding: 16px !important;
    border-radius: 10px !important;
    text-align: left !important;
  }

  /* Option cards wide - pełna szerokość na mobile */
  .option-cards--wide {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important;
  }

  .option-cards--wide .option-card {
    width: 100% !important;
    min-height: 64px !important;
    padding: 16px !important;
  }

  .form-field {
    width: 100% !important;
    max-width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    box-sizing: border-box !important;
    margin-bottom: var(--space-component) !important; /* 24px between fields */
  }

  .form-field-item {
    margin-bottom: var(--spacing-lg) !important; /* 24px */
  }

  .form-field-item--subsequent {
    margin-top: var(
      --spacing-xl
    ) !important; /* 32px for visual break (was 28px) */
  }
}

/* =============================================================================
   6. MOBILE BUILDING TYPE CARDS — OPTIMIZED TOUCH & SPACING
   ============================================================================= */

@media (max-width: 767px) {
  .building-type-cards {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-md); /* 16px both horiz + vert (was 14px) */
    margin: var(--spacing-md) auto; /* 16px top/bottom */
    justify-items: center;
    width: 100%;
    max-width: 100%;
  }

  .building-type-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm); /* 12px icon → label (was 14px) */
    width: 100%;
    max-width: 100%;
    min-height: 136px !important; /* 17×8px grid (was 140px) */
    padding: var(
      --spacing-md
    ) !important; /* 16px symmetric (was 18px/14px asymmetric) */
    background: #fff;
    border: 2px solid var(--color-border) !important;
    border-radius: var(--radius-sm) !important;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
    cursor: pointer;
    position: relative;
  }

  .building-type-card:active {
    transform: scale(0.97) !important;
    background: #fafafa !important;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
  }

  .building-type-card__icon img {
    width: 80px !important;
    height: 80px !important;
    object-fit: contain;
  }

  .building-type-card__label {
    font-size: 16px !important;
    font-weight: 500 !important;
    color: var(--color-text-primary);
    text-align: center;
    line-height: 1.4;
    margin-bottom: var(--spacing-sm) !important; /* 12px */
  }
}

/* =============================================================================
   7. MOBILE FORM INPUTS — OPTIMIZED TOUCH TARGETS
   ============================================================================= */

@media (max-width: 767px) {
  /* Text inputs, selects - OPTIMIZED HEIGHT */
  input[type="text"],
  input[type="email"],
  input[type="tel"],
  input[type="number"],
  select,
  textarea {
    width: 100%;
    min-height: var(--touch-optimal) !important; /* 52px (was 52px) */
    height: var(--touch-optimal) !important;
    padding: var(--spacing-sm) var(--content-pad) !important; /* 12px 16px */
    font-size: 16px !important; /* Prevent iOS zoom */
    border: 2px solid var(--color-border) !important;
    border-radius: var(--radius-sm) !important;
    background: #fff;
    transition: border-color 0.25s cubic-bezier(0.4, 0, 0.2, 1),
      box-shadow 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    -webkit-appearance: none;
    appearance: none;
    box-sizing: border-box !important;
    max-width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }

  input:focus,
  select:focus,
  textarea:focus {
    outline: none;
    border-color: var(--color-accent);
    box-shadow: var(--shadow-selected); /* Enhanced: 4px/0.16 (was 3px/0.12) */
  }

  /* Select dropdown */
  select {
    padding-right: 40px !important;
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="%23374151"><path d="M4.5 6l3.5 3.5L11.5 6h-7z"/></svg>');
    background-position: right 12px center;
    background-repeat: no-repeat;
    background-size: 16px;
  }

  /* Number inputs with steppers */
  .number-input-wrapper {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm); /* 12px (was 14px) */
  }

  .number-input-wrapper input {
    flex: 1;
    text-align: center;
    font-size: 18px;
    font-weight: 600;
    font-feature-settings: "tnum";
  }

  .number-input-wrapper button {
    width: var(--touch-optimal); /* 52px (was 48px) */
    height: var(--touch-optimal);
    border-radius: 2px;
    background: #f3f4f6;
    border: 2px solid var(--color-border);
    font-size: 20px;
    color: #374151;
    display: grid;
    place-items: center;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .number-input-wrapper button:active {
    background: #e5e7eb;
    transform: scale(0.96);
  }

  /* Form labels - CONSISTENT SPACING */
  .form-label,
  label {
    display: block;
    position: relative;
    font-size: 15px !important;
    font-weight: 600;
    color: var(--color-text-primary);
    padding-left: var(--content-pad) !important; /* 16px */
    margin-bottom: 2px !important; /* UJEDNOLICONE: 2px dół (minimalny odstęp pod labelem) */
    line-height: 1.5;
  }

  /* Legacy labels with leading marker alignment */
  label::before,
  .form-label::before {
    width: 6px;
    height: 6px;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
  }

  /* Field notes */
  .field-note {
    display: block;
    font-size: 13px;
    line-height: 1.5;
    color: var(--color-text-secondary);
    margin-top: var(--spacing-xs); /* 8px (was 8px) */
  }

  textarea {
    min-height: 100px !important;
    height: auto !important;
    resize: vertical;
  }
}

/* =============================================================================
   8. MOBILE RADIO BUTTONS & CHECKBOXES — OPTIMIZED TOUCH & SPACING
   ============================================================================= */

@media (max-width: 767px) {
  /* Radio button wrapper */
  .radio-option-mobile,
  .radio-button-group label {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm); /* 12px (was 14px) */
    min-height: var(--touch-primary); /* 56px (was 54px) */
    padding: var(--spacing-md); /* 16px symmetric (was 16px) */
    background: #fff;
    border: 2px solid var(--color-border);
    border-radius: 2px;
    cursor: pointer;
    transition: all 0.15s ease;
    margin-bottom: var(--spacing-sm); /* 12px (was 10px) */
  }

  .radio-option-mobile:active {
    background: #fafafa;
    transform: scale(0.98);
  }

  /* Hide native input */
  .radio-option-mobile input,
  .radio-button-group input {
    position: absolute;
    opacity: 0;
    pointer-events: none;
  }

  /* Custom radio visual */
  .radio-custom {
    width: 24px;
    height: 24px;
    border: 2px solid #d1d5db;
    border-radius: 50%;
    position: relative;
    flex-shrink: 0;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .radio-option-mobile input:checked ~ .radio-custom,
  .radio-button-group input:checked ~ .radio-custom {
    border-color: var(--color-selected);
    background: var(--color-selected);
  }

  .radio-option-mobile input:checked ~ .radio-custom::after,
  .radio-button-group input:checked ~ .radio-custom::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 10px;
    height: 10px;
    background: #fff;
    border-radius: 50%;
  }

  /* Radio label */
  .radio-label {
    font-size: 15px;
    font-weight: 500;
    color: var(--color-text-primary);
  }

  /* Selected state */
  .radio-option-mobile input:checked ~ .radio-label {
    font-weight: 600;
    color: var(--color-selected);
  }

  /* App-native radio groups (used in calculator.html) */
  .form-field__radio-group,
  #hotWaterOptions .form-field__radio-group {
    display: flex !important;
    flex-direction: column !important;
    gap: var(--spacing-sm) !important; /* 12px (was 14px) */
    width: 100% !important;
    max-width: 100% !important;
    margin-top: 4px !important;
    padding: 0 !important;
    box-sizing: border-box !important;
  }

  .form-field__radio-label {
    min-height: var(--touch-primary) !important; /* 56px (was 58px) */
    padding: var(--spacing-md) !important; /* 16px symmetric (was 16px 18px) */
    border: 2px solid var(--color-border) !important;
    border-radius: var(--radius-sm) !important;
    display: flex !important;
    align-items: center !important;
    gap: var(--spacing-sm) !important; /* 12px (was 14px) */
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    -webkit-tap-highlight-color: rgba(100, 116, 139, 0.1);
    touch-action: manipulation;
    transition: transform 0.15s ease, border-color 0.15s ease,
      background-color 0.15s ease;
  }

  .form-field__radio-label:active {
    transform: scale(0.98) !important;
    transition: transform 0.15s cubic-bezier(0.4, 0, 0.2, 1),
      border-color 0.25s cubic-bezier(0.4, 0, 0.2, 1),
      background-color 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .form-field__radio-label:has(input:checked) {
    border-color: var(--color-border-strong, #2b2b2b) !important;
    background: var(--color-surface-2, #f7f7f7) !important;
    box-shadow: none !important;
  }

  .form-field__radio-label input[type="radio"] {
    -webkit-appearance: none !important;
    appearance: none !important;
    width: 22px !important;
    height: 22px !important;
    min-width: 22px !important;
    min-height: 22px !important;
    position: relative !important;
    flex-shrink: 0 !important;
    margin: 0 !important;
    border: 2px solid rgba(20, 20, 20, 0.14) !important; /* default (nie-szare jak systemowe) */
    border-radius: 50% !important;
    background: #fff !important;
    box-shadow: none !important;
    outline: none !important;
  }

  /* Usuń systemową szarość przy zaznaczeniu */
  .form-field__radio-label input[type="radio"]:checked {
    border-color: var(--color-gold) !important;
  }

  .form-field__radio-label input[type="radio"]:checked::after {
    content: "✓" !important;
    position: absolute !important;
    width: 30px !important;
    height: 30px !important;
    background: var(--color-gold) !important;
    border: 2px solid var(--color-gold) !important; /* złota obwódka jak środek */
    border-radius: 50% !important;
    display: grid !important;
    place-items: center !important;
    color: #fff !important;
    font-size: 16px !important;
    font-weight: 700 !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    line-height: 1 !important;
    pointer-events: none !important;
  }

  .form-field__radio-label span {
    font-size: 15px !important;
    line-height: 1.55 !important;
    flex: 1 !important;
    min-width: 0 !important;
    color: var(--color-text-primary) !important;
  }

  /* Heated floors checkboxes */
  #heatedFloorsContainer {
    margin-left: 0 !important;
    padding-left: 0 !important;
    width: 100% !important;
  }

  #heatedFloorsContainer label {
    min-height: var(--touch-primary) !important; /* 56px (was 58px) */
    padding: var(--spacing-sm) 0 !important; /* 12px vertical (was 14px) */
    display: flex !important;
    align-items: center !important;
    gap: var(--spacing-sm) !important; /* 12px (was 14px) */
    width: 100% !important;
    box-sizing: border-box !important;
  }

  #heatedFloorsContainer label input[type="checkbox"] {
    width: 22px !important;
    height: 22px !important;
    min-width: 22px !important;
    min-height: 22px !important;
    border-width: 2px !important;
    flex-shrink: 0 !important;
    accent-color: var(--color-selected, #d4a574) !important;
  }
}

/* =============================================================================
   9. MOBILE HELP BOXES (ACCORDION)
   Based on: MOBILE_ANALYSIS_REPORT.md section 8.2 E
   Intelligent accordion auto-detection via mobileController.js
   ============================================================================= */

@media (max-width: 767px) {
  /* Base help-box styles - FLAT DESIGN (no accordion, always open) */
  .help-box {
    background: #f5f5f5 !important; /* Delikatnie ciemniejsze tło (was #faf9f9) */
    border: none !important; /* No border - flat design */
    border-radius: 2px !important; /* 2px radius */
    overflow: visible !important;
    width: 100% !important; /* ✅ FIXED: Pełna szerokość */
    max-width: 100% !important;
    margin-left: 0 !important; /* ✅ FIXED: Bez przesunięcia */
    margin-right: 0 !important;
    margin-top: 6px !important; /* UJEDNOLICONE: 6px góra */
    margin-bottom: 0px !important; /* UJEDNOLICONE: 0px dół */
    padding: 20px var(--content-pad) !important; /* Always open - direct padding */
    transition: none !important; /* No transitions - flat design */
  }

  /* REMOVED: Accordion functionality - all help-boxes always open */
  /* REMOVED: .help-box--accordion */
  /* REMOVED: .help-box--always-open (all are always open now) */

  /* REMOVED: All accordion functionality - help-boxes are always open */

  /* Help-box content - always visible (no accordion) */
  .help-box h4,
  .help-box h3 {
    font-size: 16px !important;
    font-weight: 700;
    margin: 0 0 12px !important;
    color: var(--color-text-primary);
    display: flex;
    align-items: center;
    gap: 8px;
    line-height: 1.4 !important;
    letter-spacing: -0.01em;
  }

  .help-box p {
    font-size: 15px !important;
    line-height: 1.65 !important;
    margin: 0 0 10px !important;
    color: var(--color-text-secondary);
  }

  .help-box p:last-child {
    margin-bottom: 0 !important;
  }

  .help-box strong {
    font-weight: 600;
    color: var(--color-text-primary);
  }

  .help-box img,
  .help-box .zone-map {
    width: 100% !important;
    max-width: 100% !important;
    height: auto !important;
    margin-top: 12px;
    border-radius: 2px !important; /* 2px radius */
    object-fit: contain !important;
    display: block !important;
  }

  /* Icon inside help box title (if present in HTML) */
  .help-box h4 i,
  .help-box h3 i {
    color: var(--color-accent);
    font-size: 18px;
  }
}

/* =============================================================================
   10. MOBILE BOTTOM NAVIGATION
   ============================================================================= */

@media (max-width: 767px) {
  .step-nav,
  .bottom-nav-mobile {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    display: flex;
    gap: 16px; /* 14px → 16px for clearer primary action separation */
    padding: 18px; /* 16px → 18px for more comfortable frame */
    padding-bottom: calc(18px + env(safe-area-inset-bottom));
    background: #fff;
    border-top: 1px solid var(--color-border);
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.08); /* 8px/0.06 → 10px/0.08 for more definition */
    z-index: 90;
    transform: translateY(0);
    transition: transform 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Hide on keyboard open */
  .bottom-nav-mobile.hidden,
  .step-nav.hidden {
    transform: translateY(100%);
  }

  /* Back button */
  .btn-step,
  #nav-prev,
  .btn-back {
    flex: 1;
    height: var(--touch-large);
    border-radius: 2px;
    font-size: 16px;
    font-weight: 500;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    background: #fff;
    border: 1px solid #d1d5db;
    color: #1a1a1a;
    text-transform: none;
    letter-spacing: 0;
  }

  /* Animacja ikon - workflow style */
  .btn-step i,
  #nav-prev i,
  #nav-next i,
  .btn-next i,
  .btn-back i {
    transition: transform 0.25s ease;
  }

  /* Hover - workflow style (dla urządzeń które wspierają hover) */
  @media (hover: hover) {
    .btn-step:hover:not(:disabled),
    #nav-prev:hover:not(:disabled),
    .btn-back:hover:not(:disabled) {
      border-color: #6b7280;
      transform: translateY(-1px);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);
    }

    .btn-next:hover:not(:disabled) i,
    #nav-next:hover:not(:disabled) i {
      transform: translateX(3px);
    }

    .btn-back:hover:not(:disabled) i,
    #nav-prev:hover:not(:disabled) i {
      transform: translateX(-3px);
    }
  }

  .btn-step:disabled,
  #nav-prev:disabled {
    opacity: 0.4;
    cursor: not-allowed;
  }

  /* Next button */
  .btn-step.btn-next,
  #nav-next,
  .btn-next {
    flex: 1;
    /* FIX: Na mobile „Dalej” musi być wyraźnym CTA.
       W praktyce bywało niewidoczne (biały tekst na białym tle) przez mieszanie styli z konfiguratora. */
    background: #2b2b2b !important;
    border: 1px solid #2b2b2b !important;
    color: #ffffff !important;
    box-shadow: none;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    text-transform: none;
    letter-spacing: 0;
  }

  /* Disabled state: nadal widoczne, ale „wyszarzone” (bez efektu znikania) */
  #nav-next:disabled,
  .btn-step.btn-next:disabled,
  .btn-next:disabled {
    opacity: 0.55 !important;
    background: #2b2b2b !important;
    border-color: #2b2b2b !important;
    color: #ffffff !important;
  }

  .btn-next:active:not(:disabled) {
    transform: scale(0.99);
    box-shadow: none;
  }

  /* Placeholder to prevent content jump */
  body.has-bottom-nav {
    padding-bottom: calc(
      84px + env(safe-area-inset-bottom)
    ) !important; /* 80px → 84px for updated nav height */
  }

  /* Ensure bottom nav doesn't cover content */
  .section.active {
    padding-bottom: calc(
      28px + 84px
    ) !important; /* 24px/80px → 28px/84px for updated section padding + nav height */
  }
}

/* =============================================================================
   11. MOBILE CONFIGURATOR SELECTION BAR
   ============================================================================= */

@media (max-width: 767px) {
  .configurator-selections-bar {
    padding: 10px 0; /* Zmniejszone z 12px */
    background: #fff;
    border-bottom: 1px solid var(--color-border);
    position: sticky;
    top: var(--header-height, 0);
    z-index: 95;
    overflow: hidden;
  }

  /* Horizontal scroll chips */
  .selections-inner {
    display: flex;
    gap: 6px; /* Zmniejszone z 8px */
    overflow-x: auto;
    padding: 0 16px;
    scroll-snap-type: x proximity;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }

  .selections-inner::-webkit-scrollbar {
    display: none;
  }

  /* Selection chip */
  .selection-item {
    flex: 0 0 auto;
    display: flex;
    flex-direction: column;
    gap: 4px;
    padding: 8px 10px; /* Zmniejszone z 8px 12px */
    background: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 2px;
    scroll-snap-align: start;
    min-width: 100px; /* Zmniejszone z 120px */
  }

  .selection-label {
    font-size: 10px; /* Zmniejszone z 11px */
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: #6b7280;
  }

  .selection-value {
    font-size: 12px; /* Zmniejszone z 13px */
    font-weight: 600;
    color: var(--color-text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .selection-item.selected {
    background: var(--color-selected-bg);
    border-color: var(--color-selected);
  }

  .selection-item .selection-value:empty::before {
    content: "—";
    color: #9ca3af;
  }
}

/* =============================================================================
   12. MOBILE PRODUCT CARDS (CONFIGURATOR)
   ============================================================================= */

@media (max-width: 767px) {
  /* TEMP: ukryj AI coach dock + panel "Decyzja techniczna" na mobile (na razie) */
  [data-role="ai-coach-dock"],
  [data-role="ai-coach-panel"] {
    display: none !important;
  }

  /* Scope to configurator to avoid colliding with calculator option cards */
  #configurator-app .options-grid,
  #configurator-view .options-grid,
  .configurator-container .options-grid {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px; /* Zmniejszone z 16px */
    padding: 12px 16px; /* Zaktualizowane z 16px */
    margin-bottom: 16px;
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
  }

  #configurator-app .option-card,
  #configurator-view .option-card,
  .configurator-container .option-card,
  #configurator-app .product-card,
  #configurator-view .product-card,
  .configurator-container .product-card {
    background: #fff;
    border: 2px solid var(--color-border);
    border-radius: 2px;
    overflow: hidden;
    transition: all 0.15s ease;
    cursor: pointer;
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
  }

  /* Selected state */
  #configurator-app .option-card--selected,
  #configurator-view .option-card--selected,
  .configurator-container .option-card--selected,
  #configurator-app .product-card.selected,
  #configurator-view .product-card.selected,
  .configurator-container .product-card.selected {
    border-color: var(--color-border-strong, #2b2b2b);
    box-shadow: none;
    animation: cardSelect 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  @keyframes cardSelect {
    0% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.02);
    }
    100% {
      transform: scale(1);
    }
  }

  /* Product image */
  #configurator-app .option-card__image,
  #configurator-view .option-card__image,
  .configurator-container .option-card__image,
  #configurator-app .product-image,
  #configurator-view .product-image,
  .configurator-container .product-image {
    position: relative;
    height: 132px !important; /* bardziej kompaktowe na mobile */
    background: #f9fafb;
    display: grid;
    place-items: center;
    padding: 10px !important;
  }

  #configurator-app .option-card__image img,
  #configurator-view .option-card__image img,
  .configurator-container .option-card__image img,
  #configurator-app .product-image img,
  #configurator-view .product-image img,
  .configurator-container .product-image img {
    max-width: 100%;
    max-height: 112px !important;
    object-fit: contain;
  }

  /* Product badge */
  #configurator-app .product-badge,
  #configurator-view .product-badge,
  .configurator-container .product-badge,
  #configurator-app .option-card__badge,
  #configurator-view .option-card__badge,
  .configurator-container .option-card__badge {
    position: absolute;
    top: 10px; /* Zmniejszone z 12px */
    right: 10px; /* Zmniejszone z 12px */
    padding: 8px 14px; /* Zwiększone z 4px 10px */
    background: linear-gradient(135deg, #d4a574, #b8976a);
    color: #fff;
    font-size: 12px; /* Zwiększone z 11px */
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-radius: 2px;
  }

  /* Product content */
  #configurator-app .option-card__content,
  #configurator-view .option-card__content,
  .configurator-container .option-card__content,
  #configurator-app .product-content,
  #configurator-view .product-content,
  .configurator-container .product-content {
    padding: 12px 14px 14px !important; /* bardziej kompaktowe */
  }

  #configurator-app .option-card__title,
  #configurator-view .option-card__title,
  .configurator-container .option-card__title,
  #configurator-app .product-title,
  #configurator-view .product-title,
  .configurator-container .product-title {
    font-size: 16px !important;
    line-height: 1.25 !important;
    font-weight: 700;
    color: var(--color-text-primary);
    margin: 0 0 6px; /* Zwiększone z 4px */
  }

  #configurator-app .option-card__description,
  #configurator-view .option-card__description,
  .configurator-container .option-card__description,
  #configurator-app .product-desc,
  #configurator-view .product-desc,
  .configurator-container .product-desc {
    font-size: 13px !important;
    color: #6b7280;
    margin: 0 0 10px !important;
    line-height: 1.45 !important;
    line-clamp: 2; /* standard property for compatibility */
    display: -webkit-box !important;
    -webkit-line-clamp: 2 !important;
    -webkit-box-orient: vertical !important;
    overflow: hidden !important;
  }

  /* Product specs */
  #configurator-app .product-specs,
  #configurator-view .product-specs,
  .configurator-container .product-specs,
  #configurator-app .option-card__specs,
  #configurator-view .option-card__specs,
  .configurator-container .option-card__specs {
    display: none !important; /* na mobile za dużo szumu */
  }

  .spec {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 13px;
    font-weight: 600;
    color: #374151;
  }

  .spec svg {
    width: 16px;
    height: 16px;
    color: var(--color-selected);
  }

  /* Select button */
  #configurator-app .product-select,
  #configurator-view .product-select,
  .configurator-container .product-select,
  #configurator-app .option-card__button,
  #configurator-view .option-card__button,
  .configurator-container .option-card__button {
    width: calc(100% - 32px);
    margin: 0 16px 16px;
    height: 48px;
    background: transparent;
    border: 2px solid var(--color-border);
    border-radius: 2px;
    font-size: 16px;
    font-weight: 600;
    color: #374151;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.15s ease;
    cursor: pointer;
  }

  #configurator-app .option-card--selected .product-select,
  #configurator-view .option-card--selected .product-select,
  .configurator-container .option-card--selected .product-select,
  #configurator-app .option-card--selected .option-card__button,
  #configurator-view .option-card--selected .option-card__button,
  .configurator-container .option-card--selected .option-card__button {
    background: var(--color-selected);
    border-color: var(--color-selected);
    color: #fff;
  }

  /* ==========================================================================
     SECTION HEADER - Typography i spacing
     ========================================================================== */
  .section-header {
    padding: 16px 0 !important; /* Zwiększone z 11px dla lepszego oddechu */
  }

  .section-step {
    font-size: 12px !important; /* Zmniejszone z 13px */
    margin-bottom: 6px !important; /* Zwiększone z 4px */
  }

  .section-title {
    font-size: 18px !important; /* Zmniejszone z 20px */
    margin: 0 0 6px 0 !important; /* Zwiększone z 3px */
    line-height: 1.3 !important; /* Zwiększone z 1.2 */
  }

  .section-description {
    font-size: 14px !important; /* Zwiększone z 13px */
    line-height: 1.6 !important; /* Zwiększone z 1.5 */
    margin-top: 4px !important;
  }

  /* ==========================================================================
     STEP NAVIGATION - Touch targets i spacing
     ========================================================================== */
  .step-nav {
    padding: 12px 16px !important; /* Zwiększone z 11px 0 */
    gap: 12px !important; /* Zmniejszone z 14px */
  }

  .btn-step {
    padding: 14px 24px !important; /* Zmniejszone z 16px 32px */
    font-size: 16px !important; /* Zwiększone z 15px */
    min-width: 100px !important; /* Zmniejszone z 120px */
    min-height: 48px !important; /* Touch target */
    font-weight: 600 !important;
  }

  /* ==========================================================================
     FORM FIELDS - Touch targets
     ========================================================================== */
  #configurator-app .form-field-item {
    margin-bottom: 20px !important; /* Zwiększone dla lepszego spacing */
  }

  #configurator-app .form-field-item input[type="checkbox"] {
    width: 24px !important; /* Zwiększone z 20px */
    height: 24px !important; /* Zwiększone z 20px */
    cursor: pointer;
    accent-color: var(--color-gold, #d4a574);
  }

  #configurator-app .form-field-item label {
    cursor: pointer;
    font-size: 15px !important; /* Zwiększone dla lepszej czytelności */
  }

  #configurator-app .form-field-item .micro-note {
    font-size: 13px !important; /* Zwiększone z 0.9rem */
    color: #6b7280;
    margin-top: 8px !important;
    margin-bottom: 0;
    line-height: 1.6 !important; /* Zwiększone z 1.5 */
  }

  #configurator-app .form-select {
    padding: 14px 16px !important; /* Zwiększone dla lepszego touch target */
    font-size: 16px !important; /* Zapobiega zoom na iOS */
    min-height: 48px !important; /* Touch target */
  }

  /* ==========================================================================
     SUMMARY PAGE - Layout mobile
     ========================================================================== */
  .summary-header {
    padding: 24px 16px !important; /* Zmniejszone z 36px */
  }

  .summary-header h1 {
    font-size: 20px !important; /* Zmniejszone z 22px */
    margin-bottom: 16px !important; /* Zmniejszone z 20px */
  }

  .summary-header p {
    font-size: 14px !important; /* Zmniejszone z 15px */
    line-height: 1.6 !important;
  }

  .summary-badge {
    margin-top: 20px !important; /* Zmniejszone z 28px */
    padding-top: 20px !important; /* Zmniejszone z 28px */
    font-size: 12px !important; /* Zmniejszone z 13px */
  }

  /* Summary table - CRITICAL: Wrap in .summary-table-wrapper with overflow-x: auto */
  .summary-table-wrapper {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    margin: 0 calc(-1 * var(--content-pad)) !important; /* Extend to edges */
    padding: 0 var(--content-pad) !important;
  }

  .summary-table {
    font-size: 14px !important;
    min-width: 320px; /* Minimum readable width for small screens */
  }

  .summary-table td {
    padding: 12px 16px !important; /* Zwiększone dla lepszego touch */
    min-height: 48px !important; /* Touch target */
  }

  .summary-actions {
    padding: 16px !important;
    gap: 12px !important;
  }

  .summary-actions .btn {
    width: 100% !important; /* Full width na mobile */
    min-height: 48px !important; /* Touch target */
    font-size: 16px !important;
    padding: 14px 24px !important;
  }

  /* ==========================================================================
     BADGE I IKONY - Wizualne dopracowanie (dodatkowe)
     ========================================================================== */
  .product-card.selected::after {
    width: 28px !important; /* Zwiększone z 24px */
    height: 28px !important; /* Zwiększone z 24px */
    font-size: 16px !important; /* Zwiększone z 14px */
    bottom: 10px !important;
    right: 10px !important;
  }

  .spec-icon {
    font-size: 16px !important; /* Zwiększone z 14px */
  }

  /* ==========================================================================
     PRICE DISPLAY - Optymalizacja
     ========================================================================== */
  .product-price,
  #configurator-app .option-price {
    padding-top: 12px !important; /* Zwiększone z 7px */
    margin-top: 8px !important;
  }

  .product-price::before,
  #configurator-app .option-price::before {
    font-size: 12px !important; /* Zwiększone z 11px */
    margin-bottom: 6px !important; /* Zwiększone z 4px */
  }

  .price-value {
    font-size: 22px !important; /* Zwiększone z 20px */
  }

  .price-currency {
    font-size: 14px !important; /* Zwiększone z 13px */
  }

  /* ==========================================================================
     RECOMMENDATION NOTE - Spacing
     ========================================================================== */
  .recommendation-note {
    padding: 16px !important; /* Zwiększone z 14px */
    margin-bottom: 24px !important; /* Zwiększone z 20px */
  }

  .recommendation-note p {
    font-size: 15px !important; /* Zwiększone z 14px */
    line-height: 1.6 !important; /* Zwiększone z 1.5 */
  }

  /* ==========================================================================
     SPECS LIST - Optymalizacja mobile
     ========================================================================== */
  .specs-list {
    padding-top: 10px !important; /* Zwiększone z 6px */
    margin-top: 6px !important; /* Zwiększone z 3px */
    margin-bottom: 10px !important; /* Zwiększone z 6px */
  }

  .spec-row {
    padding: 4px 0 !important; /* Zwiększone z 3px */
    font-size: 13px !important; /* Zmniejszone z 14px */
  }

  .spec-label {
    font-size: 12px !important; /* Zmniejszone z 13px */
  }

  .spec-value {
    font-size: 13px !important; /* Zmniejszone z 14px */
  }

  /* ==========================================================================
     INSTALLATION NOTE - Mobile optimization
     ========================================================================== */
  .installation-note {
    padding: 10px 12px !important; /* Zwiększone z 7px 8px */
    margin: 8px 0 12px 0 !important; /* Zwiększone z 6px 0 8px 0 */
    font-size: 13px !important; /* Zwiększone z 12px */
    line-height: 1.6 !important; /* Zwiększone z 1.5 */
  }

  .installation-note strong {
    font-size: 14px !important; /* Zwiększone z 13px */
    margin-bottom: 6px !important; /* Zwiększone z 4px */
  }

  /* ==========================================================================
     MAIN CONTAINER - Mobile padding
     ========================================================================== */
  #configurator-app {
    padding-left: 16px !important; /* Zmniejszone z 20px */
    padding-right: 16px !important; /* Zmniejszone z 20px */
    padding-bottom: 16px !important; /* Zmniejszone z 20px */
  }

  /* ==========================================================================
     UJEDNOLICENIE BORDER-RADIUS - Wszystkie elementy na 2px (mobile)
     ========================================================================== */
  /* Karty, boxy, kontenery */
  .glass-box,
  .form-card,
  .option-card,
  .product-card,
  #configurator-app .option-card,
  #configurator-app .product-card,
  .configurator-container .option-card,
  .configurator-container .product-card {
    border-radius: var(
      --radius-sm
    ) !important; /* Zamiast var(--radius-sm) - bezpośrednia wartość */
  }

  /* Input fields, selecty */
  input[type="text"],
  input[type="email"],
  input[type="tel"],
  input[type="number"],
  input[type="password"],
  .form-select,
  select,
  #configurator-app .form-select,
  #configurator-app select {
    border-radius: var(--radius-sm) !important;
  }

  /* Przyciski */
  button,
  .btn,
  .btn-step,
  .btn-next,
  .btn-back,
  .btn-next1,
  .btn-next2,
  .btn-next3,
  .btn-next4,
  .btn-next5,
  .btn-finish,
  .btn-prev,
  .summary-actions .btn,
  #configurator-app .product-select,
  #configurator-app .option-card__button {
    border-radius: var(--radius-sm) !important;
  }

  /* Badge, tagi */
  .badge-recommended,
  .product-badge,
  .option-card__badge,
  #configurator-app .product-badge,
  #configurator-app .option-card__badge {
    border-radius: var(--radius-sm) !important;
  }

  /* Selection chips */
  .selection-item {
    border-radius: var(--radius-sm) !important;
  }

  /* Help box, info box */
  .help-box,
  .recommendation-note,
  .installation-note,
  .option-content,
  .product-content {
    border-radius: var(--radius-sm) !important;
  }

  /* Form field items - ujednolicenie */
  .form-field-item,
  #configurator-app .form-field-item {
    border-radius: var(--radius-sm) !important;
  }

  /* Summary elements */
  .summary-header,
  .summary-badge,
  .summary-table {
    border-radius: 0 !important; /* Tabele i header bez border-radius */
  }

  /* Specyficzne dla konfiguratora - ujednolicenie wszystkich kontenerów */
  #configurator-app .glass-box,
  #configurator-app .form-card,
  #configurator-app .option-content,
  #configurator-app .product-content {
    border-radius: var(--radius-sm) !important;
  }

  /* Override dla wszystkich elementów używających var(--radius-sm) lub większych wartości */
  .form-card,
  .form-field,
  .form-field-item,
  .form-row-mosaic,
  .section,
  .option-cards,
  .yes-no-cards,
  .btn-row,
  .summary-header,
  .summary-badge {
    border-radius: var(--radius-sm) !important;
  }

  /* Results switcher i result grid - ujednolicenie */
  .results-switch-btn,
  .result-grid,
  .slider-confirm-card {
    min-width: 140px !important;
    width: 100% !important;
    max-width: 200px !important;
    height: 48px !important;
    min-height: 48px !important;
    padding: 0 20px !important;
    margin-top: 8px !important;
    align-self: center !important;
    border-radius: var(--radius-sm) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08) !important;
  }

  /* FIX: results-switcher to kontener (na mobile bywa w kolumnie), nie może mieć stałej wysokości/max-width,
     bo wtedy drugi przycisk „wypływa” i nachodzi na configurator view. */
  .results-switcher,
  [data-role="results-switcher"] {
    height: auto !important;
    min-height: unset !important;
    max-width: 100% !important;
    width: 100% !important;
    align-self: stretch !important;
    margin-top: 0 !important;
  }

  .slider-confirm-card__hint {
    font-size: 12px !important;
    border-radius: var(--radius-sm) !important;
  }

  /* Override dla elementów z większymi wartościami (3px, 4px) - tylko dla standardowych elementów UI */
  /* Modale i tooltips mogą mieć większe wartości jeśli są potrzebne */

  /* Progress bar - ujednolicenie */
  .form-progress {
    border-radius: var(--radius-sm) !important; /* Zamiast var(--radius-sm) */
  }

  .form-progress-fill {
    border-radius: var(--radius-sm) !important;
  }

  /* Yes/No cards */
  .yes-no-card {
    border-radius: var(--radius-sm) !important;
  }

  /* Summary table cells (jeśli mają border-radius) */
  .summary-table td,
  .summary-table th {
    border-radius: 0 !important; /* Tabele bez border-radius */
  }

  /* Override dla większych wartości - usunięto pusty selektor */
}

/* =============================================================================
   12b. MOBILE CALCULATOR OPTION / YES-NO CARDS + BUTTON ROW (ported from main.css)
   ============================================================================= */

@media (max-width: 767px) {
  /* Yes/No cards - 2 kolumny side-by-side, wycentrowane */
  .yes-no-cards {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 14px !important; /* 12px → 14px for better separation */
    width: 100% !important;
    max-width: 100% !important;
    margin: 4px auto 0 !important; /* auto centering + subtle top margin */
    justify-items: center; /* center cards within grid cells */
  }

  .yes-no-card {
    width: 100% !important;
    max-width: 100% !important;
    min-height: 56px !important;
    padding: 18px 22px !important; /* 16px/20px → 18px/22px for more comfortable touch */
    font-size: 16px !important;
    font-weight: 600;
    border: 2px solid var(--color-border) !important; /* 1px → 2px for better visibility */
    border-radius: var(--radius-sm) !important;
    background: #fff !important;
    transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1),
      border-color 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }

  .yes-no-card:active {
    transform: scale(0.97) !important;
    transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1),
      border-color 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important; /* refined timing */
  }

  .yes-no-card.yes-no-card--selected {
    border-color: var(--color-border-strong, #2b2b2b) !important;
    border-width: 2px !important;
    background: var(--color-surface-2, #f7f7f7) !important;
    box-shadow: none !important;
  }

  /* Building type cards - złoty kolor dla selected */
  .building-type-card.building-type-card--selected {
    border-color: var(--color-border-strong, #2b2b2b) !important;
    border-width: 2px !important;
    background: var(--color-surface-2, #f7f7f7) !important;
    box-shadow: none !important;
  }

  /* Option cards container */
  .option-cards {
    display: flex !important;
    flex-direction: column !important;
    gap: 14px !important;
    width: 100% !important;
    max-width: 100% !important;
    margin: 4px auto 0 !important; /* auto centering */
    align-items: center; /* center cards horizontally */
  }

  /* Calculator option cards (form option tiles) */
  .option-card {
    width: 100% !important;
    max-width: 100% !important;
    min-height: 64px !important;
    padding: 18px 20px !important; /* 16px/18px → 18px/20px for better balance */
    border: 2px solid var(--color-border) !important; /* 1px → 2px for clarity */
    border-radius: var(--radius-sm) !important;
    background: #fff !important;
    transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1),
      border-color 0.2s cubic-bezier(0.4, 0, 0.2, 1),
      background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }

  .option-card:active {
    transform: scale(0.97) !important;
    transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1),
      border-color 0.25s cubic-bezier(0.4, 0, 0.2, 1),
      background-color 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important; /* refined timing */
  }

  .option-card.option-card--selected {
    border-color: var(--color-border-strong, #2b2b2b) !important;
    border-width: 2px !important;
    background: var(--color-surface-2, #f7f7f7) !important;
    box-shadow: none !important;
  }

  .option-card__title {
    font-size: 16px !important; /* 15px → 16px for better readability */
    font-weight: 600;
    line-height: 1.4 !important; /* add line-height for optical comfort */
    margin-bottom: 4px !important;
    color: var(--color-text-primary) !important;
  }

  .option-card__subtitle {
    font-size: 13px !important;
    line-height: 1.5 !important; /* add line-height for readability */
    color: var(--color-text-secondary) !important; /* ensure proper hierarchy */
  }

  /* Button row (calculator steps) */
  .btn-row {
    display: flex !important;
    flex-direction: column !important;
    gap: 14px !important;
    padding: 28px var(--content-pad) 0 !important;
    border-top: 1px solid var(--color-border) !important;
    background: var(--color-bg-light) !important;
    margin-top: var(--spacing-xl) !important;
    margin-left: 0 !important; /* ✅ FIXED: Usuń marginesy kontenera */
    margin-right: 0 !important;
    align-items: stretch !important; /* ✅ FIXED: Wyrównaj wszystkie przyciski do pełnej szerokości */
    box-sizing: border-box !important;
  }

  .btn-row button {
    width: 100% !important;
    max-width: 100% !important;
    margin-left: 0 !important; /* ✅ FIXED: Usuń marginesy które mogą powodować przesunięcie */
    margin-right: 0 !important;
    margin-bottom: 0 !important;
    box-sizing: border-box !important; /* ✅ FIXED: Upewnij się że padding jest wliczony w width */
  }

  /* Step buttons */
  .btn,
  .btn-step,
  #nav-prev,
  #nav-next,
  .btn-next1,
  .btn-next2,
  .btn-next3,
  .btn-next4,
  .btn-next5,
  .btn-finish {
    min-height: 58px !important; /* 56px → 58px for optimal touch target */
    height: 58px !important;
    padding: 0 26px !important; /* 24px → 26px for better horizontal balance */
    font-size: 16px !important;
    font-weight: 600;
    border-width: 2px !important;
    border-radius: var(--radius-sm) !important;
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }

  /* Configurator product cards are <button> — ensure they are NOT constrained by step button sizing */
  #configurator-app .product-card,
  #configurator-view .product-card,
  .configurator-container .product-card {
    height: auto !important;
    min-height: unset !important;
    padding: 0 !important;
  }

  .btn-row .btn-prev,
  .btn-row .btn-next1,
  .btn-row .btn-next2,
  .btn-row .btn-next3,
  .btn-row .btn-next4,
  .btn-row .btn-next5,
  .btn-row .btn-finish {
    padding: 16px 32px !important;
    border-width: 2px !important;
    border-style: solid !important;
    border-color: var(--color-border) !important;
    background: var(--color-bg-section) !important;
    color: var(--color-text-heading) !important;
    font-weight: 600 !important;
    letter-spacing: 0 !important;
    text-transform: none !important;
    min-width: 0 !important; /* ✅ FIXED: Usuń min-width - width: 100% wystarczy */
    width: 100% !important; /* ✅ FIXED: Wymuś pełną szerokość */
    max-width: 100% !important;
    margin-left: 0 !important; /* ✅ FIXED: Usuń marginesy */
    margin-right: 0 !important;
    box-sizing: border-box !important; /* ✅ FIXED: Padding wliczony w width */
    transition: all 0.15s cubic-bezier(0.25, 0.1, 0.25, 1) !important;
  }

  .btn-row .btn-next1,
  .btn-row .btn-next2,
  .btn-row .btn-next3,
  .btn-row .btn-next4,
  .btn-row .btn-next5,
  .btn-row .btn-finish {
    background: #2b2b2b !important;
    border-color: #2b2b2b !important;
    color: #ffffff !important;
  }

  .btn-prev {
    min-height: 54px !important; /* 52px → 54px for better comfort, still secondary to primary */
    height: 54px !important;
    padding: 0 24px !important; /* add explicit padding for consistency */
    font-size: 15px !important;
    border-width: 2px !important;
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }

  .btn-row [class*="btn-next"],
  .btn-row .btn-finish {
    order: 1 !important;
  }

  .btn-row .btn-prev {
    order: 2 !important;
    width: 100% !important; /* ✅ FIXED: Pełna szerokość jak btn-next */
    max-width: 100% !important;
    min-width: 0 !important; /* Usuń min-width - width: 100% wystarczy */
    margin-left: 0 !important; /* ✅ FIXED: Usuń marginesy */
    margin-right: 0 !important;
    box-sizing: border-box !important; /* ✅ FIXED: Padding wliczony w width */
    padding: 16px 32px !important; /* ✅ FIXED: Identyczny padding jak btn-next */
  }

  @media (hover: hover) {
    .btn-row .btn-next1:hover,
    .btn-row .btn-next2:hover,
    .btn-row .btn-next3:hover,
    .btn-row .btn-next4:hover,
    .btn-row .btn-next5:hover,
    .btn-row .btn-finish:hover {
      border-color: #1a1a1a !important;
      background: #1a1a1a !important;
    }

    .btn-row .btn-prev:hover {
      border-color: #999999 !important;
      background: var(--color-bg-light) !important;
    }
  }

  /* Dynamic blocks spacing (ported from main.css utilities) */
  #secondaryWallFields,
  #canadianOptions,
  #externalIsolationFields,
  #topIsolationFields,
  #bottomIsolationFields,
  #hotWaterOptions,
  #balconyFields {
    margin-top: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    margin-left: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
  }

  #balconyFields input {
    margin-left: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
  }

  #balconyFields label {
    margin-bottom: var(--spacing-sm);
  }
}

/* =============================================================================
   13. MOBILE TABS NAVIGATION
   ============================================================================= */

@media (max-width: 767px) {
  .tabs-mobile,
  [data-role="results-switcher"] {
    display: flex;
    background: #fff;
    border-bottom: 1px solid var(--color-border);
    position: sticky;
    top: 0;
    z-index: 90;
  }

  .tab,
  .results-tab {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 12px 8px;
    border-bottom: 3px solid transparent;
    font-size: 13px;
    font-weight: 600;
    color: #6b7280;
    transition: all 0.15s ease;
    cursor: pointer;
    background: transparent;
    border-top: none;
    border-left: none;
    border-right: none;
  }

  .tab svg {
    width: 20px;
    height: 20px;
  }

  .tab.active,
  .results-tab.active {
    color: var(--color-accent);
    border-bottom-color: var(--color-accent);
  }

  .tab.active svg {
    color: var(--color-accent);
  }
}

/* =============================================================================
   14. MOBILE ERROR STATES & VALIDATION
   ============================================================================= */

@media (max-width: 767px) {
  /* Error input */
  .form-input-mobile.error,
  input.error,
  select.error {
    border-color: var(--color-accent);
    background: #fef2f2;
  }

  /* Error message */
  /* ACCESSIBILITY REQUIREMENT:
   * Add aria-live="polite" to .error-message container in HTML
   * OR role="alert" for critical validation errors
   * Visual styling (border/color) is NOT sufficient for screen readers
   */
  .error-message,
  .field-error {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-top: 6px;
    font-size: 13px;
    color: var(--color-accent);
  }

  .error-message svg {
    width: 16px;
    height: 16px;
    flex-shrink: 0;
  }

  /* Toast notifications */
  .toast-mobile {
    position: fixed;
    bottom: calc(80px + env(safe-area-inset-bottom));
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 20px;
    background: #1a202c;
    color: #fff;
    border-radius: 2px;
    font-size: 14px;
    font-weight: 600;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    animation: toastSlideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 200;
    max-width: calc(100vw - 32px);
  }

  @keyframes toastSlideUp {
    from {
      transform: translate(-50%, 100px);
      opacity: 0;
    }
    to {
      transform: translate(-50%, 0);
      opacity: 1;
    }
  }

  .toast-mobile.success {
    background: var(--color-selected);
  }

  .toast-mobile.error {
    background: var(--color-accent);
  }

  .toast-mobile.fade-out {
    animation: toastFadeOut 0.3s ease forwards;
  }

  @keyframes toastFadeOut {
    to {
      opacity: 0;
      transform: translate(-50%, 20px);
    }
  }
}

/* =============================================================================
   15. MOBILE LOADING STATES
   ============================================================================= */

@media (max-width: 767px) {
  /* Loading spinner */
  .spinner-mobile {
    width: 24px;
    height: 24px;
    border: 3px solid #e5e7eb;
    border-top-color: var(--color-accent);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }

  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }

  /* Loading overlay */
  .loading-overlay-mobile {
    position: fixed;
    inset: 0;
    background: rgba(255, 255, 255, 0.9);
    display: grid;
    place-items: center;
    z-index: 300;
  }

  .loading-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 16px;
  }

  .loading-text {
    font-size: 14px;
    font-weight: 600;
    color: #374151;
  }
}

/* =============================================================================
   16. MOBILE ACCESSIBILITY
   ============================================================================= */

@media (max-width: 767px) {
  /* Focus visible indicators */
  *:focus-visible {
    outline: 3px solid var(--color-accent);
    outline-offset: 2px;
  }

  /* Skip link */
  .skip-link {
    position: absolute;
    top: -100px;
    left: 16px;
    padding: 12px 16px;
    background: var(--color-accent);
    color: #fff;
    font-size: 14px;
    font-weight: 600;
    border-radius: 2px;
    z-index: 150; /* Reduced from 1000 - top of app scale, reasonable for accessibility link */
    transition: top 0.2s ease;
  }

  .skip-link:focus {
    top: 16px;
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }
}

/* =============================================================================
   17. MOBILE UTILITIES
   ============================================================================= */

@media (max-width: 767px) {
  /* Hide on mobile */
  .hide-mobile {
    display: none !important;
  }

  /* Show only on mobile */
  .show-mobile {
    display: block !important;
  }

  /* Full width on mobile */
  .full-width-mobile {
    width: 100% !important;
    max-width: 100% !important;
  }

  /* Text truncate */
  .truncate-mobile {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  /* Spacing utilities */
  .mt-mobile-sm {
    margin-top: var(--spacing-sm);
  }
  .mt-mobile-md {
    margin-top: var(--spacing-md);
  }
  .mt-mobile-lg {
    margin-top: var(--spacing-lg);
  }

  .mb-mobile-sm {
    margin-bottom: var(--spacing-sm);
  }
  .mb-mobile-md {
    margin-bottom: var(--spacing-md);
  }
  .mb-mobile-lg {
    margin-bottom: var(--spacing-lg);
  }

  .p-mobile-sm {
    padding: var(--spacing-sm);
  }
  .p-mobile-md {
    padding: var(--spacing-md);
  }
  .p-mobile-lg {
    padding: var(--spacing-lg);
  }
}

/* =============================================================================
   18. MOBILE RESULTS / PUMP SLIDER / AI (ported from main.css)
   ============================================================================= */

@media (max-width: 767px) {
  /* Results wrapper & containers */
  .results-wrapper.section,
  .extended-section,
  .glass-box {
    width: 100% !important;
    max-width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    box-sizing: border-box !important;
  }

  /* Pump cards / slider */
  .pump-slider-wrapper,
  #pump-recommendation-zone {
    width: 100% !important;
    max-width: 100% !important;
    padding: 0 !important;
    margin: 0 !important;
    box-sizing: border-box !important;
  }

  .slider-header {
    padding: 16px !important;
    margin-bottom: 16px !important;
  }

  .slider-header h3 {
    font-size: 18px !important;
    margin-bottom: 8px !important;
  }

  .slider-header p {
    font-size: 14px !important;
  }

  .pump-cards-slider,
  .slider-track {
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
  }

  .pump-recommendation-card,
  .pump-slide {
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    padding: 16px !important;
    margin-bottom: 16px !important;
  }

  .pump-card-header {
    flex-direction: column !important;
    align-items: flex-start !important;
    gap: 8px !important;
  }

  .pump-card-image {
    width: 100% !important;
    max-width: 100% !important;
    height: auto !important;
    object-fit: contain !important;
  }

  .pump-card-badge {
    font-size: 11px !important;
    padding: 4px 8px !important;
  }

  .pump-card-title {
    font-size: 16px !important;
    margin-bottom: 6px !important;
  }

  .pump-card-type {
    font-size: 12px !important;
  }

  .pump-card-specs {
    grid-template-columns: 1fr !important;
    gap: 8px !important;
  }

  .pump-card-spec-item {
    font-size: 13px !important;
    padding: 8px !important;
  }

  .pump-card-price {
    font-size: 18px !important;
    margin-top: 12px !important;
  }

  .pump-card-button,
  .pump-card-action {
    width: 100% !important;
    padding: 14px 20px !important;
    font-size: 15px !important;
    margin-top: 12px !important;
  }

  .slider-navigation {
    padding: 12px 0 !important;
    gap: 12px !important;
  }

  .slider-btn {
    width: 40px !important;
    height: 40px !important;
    font-size: 24px !important;
  }

  .slider-dots {
    gap: 8px !important;
  }

  .slider-dot {
    width: 8px !important;
    height: 8px !important;
  }

  /* Results table */
  .results-table {
    width: 100% !important;
    font-size: 13px !important;
    overflow-x: auto !important;
  }

  .results-table thead th {
    font-size: 12px !important;
    padding: 10px 8px !important;
  }

  .results-table tbody td {
    font-size: 13px !important;
    padding: 10px 8px !important;
  }

  /* Results switcher */
  .results-switcher {
    margin-bottom: var(--spacing-lg) !important;
    padding: var(--spacing-sm) !important;
    border-radius: var(
      --radius-sm
    ) !important; /* Bezpośrednia wartość zamiast var */
    flex-direction: column !important;
    gap: 8px !important;
  }

  .results-switch-btn {
    padding: 12px 16px !important;
    min-height: 48px !important;
    font-size: 14px !important;
    border-radius: var(--radius-sm) !important; /* Ujednolicenie */
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }

  .results-switch-btn:active {
    transform: scale(0.97) !important;
  }

  .result-grid {
    grid-template-columns: 1fr !important;
    gap: var(--spacing-md) !important;
    border-radius: var(
      --radius-sm
    ) !important; /* Bezpośrednia wartość zamiast var */
    overflow: hidden;
  }

  .result-item {
    padding: 16px !important;
    min-height: 56px !important;
  }

  .result-item span {
    font-size: 15px !important;
  }

  .result-item strong {
    font-size: 17px !important;
    font-weight: 700;
  }

  .action-btn {
    min-height: 56px !important;
    padding: 16px 24px !important;
    font-size: 16px !important;
    font-weight: 500 !important;
    text-transform: none !important;
    letter-spacing: 0 !important;
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  .action-btn i {
    transition: transform 0.25s ease;
  }

  /* Hover dla urządzeń które wspierają */
  @media (hover: hover) {
    .action-btn:hover:not(:disabled) {
      border-color: #6b7280 !important;
      transform: translateY(-1px) !important;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06) !important;
    }

    .action-btn:hover i {
      transform: translateX(3px);
    }
  }

  .action-btn:active {
    transform: scale(0.98) !important;
  }

  /* AI coach dock */
  [data-role="ai-coach-dock"] {
    padding: 12px 16px !important;
    min-height: 56px !important;
    border-radius: 4px 4px 0 0 !important;
    box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1) !important;
    width: 100% !important;
    max-width: 100% !important;
    left: 0 !important;
    right: 0 !important;
    box-sizing: border-box !important;
  }

  .ai-coach-dock__content {
    width: 100% !important;
    max-width: 100% !important;
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
  }

  .ai-coach-dock__text {
    font-size: 14px !important;
    flex: 1 !important;
    line-height: 1.4 !important;
  }

  .ai-coach-dock__btn {
    width: 40px !important;
    height: 40px !important;
    min-width: 40px !important;
    min-height: 40px !important;
    flex-shrink: 0 !important;
  }
}

/* =============================================================================
   19. MOBILE CUSTOM SLIDER (ported from main.css)
   ============================================================================= */

@media (max-width: 767px) {
  .custom-slider-container {
    margin-top: 24px !important;
    padding-top: 44px !important; /* Space for bubble - aligned with spatial-mobile.css */
    padding-bottom: 16px !important;
    margin-bottom: var(--spacing-lg) !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    gap: 16px !important;
  }

  .custom-slider-track {
    height: 6px !important;
    border-radius: var(--radius-sm) !important; /* Ujednolicenie z resztą UI */
    -webkit-tap-highlight-color: transparent;
  }

  .custom-slider-thumb {
    width: 22px !important; /* Consistent with spatial-mobile.css */
    height: 22px !important;
    border-width: 2px !important;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08) !important; /* Subtle shadow */
    touch-action: none;
    transition: border-color 0.15s ease, box-shadow 0.15s ease,
      left 0.1s ease-out !important;
  }

  .custom-bubble {
    top: 0 !important; /* Aligned with main.css - container has padding-top */
    font-size: 0.85rem !important; /* Consistent with spatial-mobile.css */
    font-weight: 600 !important;
    padding: 3px 8px !important; /* Consistent sizing */
    user-select: none;
    pointer-events: none;
    min-width: 32px !important;
    text-align: center !important;
  }

  .custom-slider-ticks {
    margin-top: 8px !important; /* Consistent with main.css */
    padding: 0 4px !important; /* Prevent first/last tick from being cut off */
    box-sizing: border-box !important;
  }

  .custom-slider-ticks .tick {
    font-size: 0.8rem !important; /* Consistent with spatial-mobile.css */
    font-weight: 500;
    min-width: 24px !important; /* Prevent overlap */
    text-align: center !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    -webkit-tap-highlight-color: rgba(212, 165, 116, 0.1);
    touch-action: manipulation;
  }
}

/* =============================================================================
   21. MOBILE: DIMENSIONS QUANTITY INPUT (length/width) – better layout
   ============================================================================= */
@media (max-width: 767px) {
  /* Option cards: zwiększ wysokość/padding, żeby subtytuły (np. dach/wentylacja/ogrzewanie/CWU) były widoczne */
  .option-card {
    min-height: 88px !important;
    padding: 14px 16px !important;
  }

  .option-card__subtitle {
    display: block !important;
  }

  /* Usuń mobilne „kółka” (pseudo-radio) w option-cardach — są zbędne i robią artefakty */
  .option-card::after,
  .option-card--selected::after {
    content: none !important;
    display: none !important;
  }
}

@media (max-width: 767px) {
  /* In step "Wymiary" the margin-left from desktop shrinks the control */
  /* Dimensions Fields - układ pionowy na mobile */
  #dimensionsFields {
    display: flex !important;
    flex-direction: column !important; /* ✅ FIXED: Pionowy układ zamiast poziomego */
    gap: var(--spacing-lg) !important; /* 24px - większy odstęp między polami */
    margin-top: var(--spacing-md) !important; /* 16px - odstęp od góry */
    margin-bottom: var(--spacing-lg) !important; /* 24px - odstęp od dołu */
    width: 100% !important;
    max-width: 100% !important;
  }

  /* FIX: nawet jeśli #dimensionsFields jest flex-row (WP overrides), wymuś 100% szerokości elementów */
  .heatpump-calculator-wrapper #dimensionsFields .form-field-item--subsequent,
  #dimensionsFields .form-field-item--subsequent {
    flex: 1 1 100% !important;
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    grid-column: 1 / -1 !important;
  }

  #dimensionsFields .form-field {
    width: 100% !important;
    max-width: 100% !important;
    margin-bottom: 0 !important; /* Usuń margin-bottom - gap obsługuje odstępy */
  }

  #dimensionsFields .form-field-item {
    width: 100% !important;
    max-width: 100% !important;
    margin-bottom: var(--spacing-sm) !important; /* 12px - odstęp pod labelem */
  }

  #dimensionsFields .form-label {
    margin-bottom: var(
      --spacing-xs
    ) !important; /* 8px - odstęp pod labelem przed inputem */
  }

  #dimensionsFields .quantity-input-wrapper {
    margin-left: 0 !important;
    margin-top: var(--spacing-xs) !important; /* 8px - odstęp od labela */
    width: 100% !important;
    max-width: 100% !important;
    justify-content: flex-start !important; /* Wyrównanie do lewej zamiast centrum */
    gap: 10px !important;
  }

  #dimensionsFields .quantity-input {
    width: 100% !important;
    max-width: 100% !important; /* ✅ FIXED: Pełna szerokość zamiast 260px */
  }

  #dimensionsFields .quantity-input input[type="number"] {
    min-width: 120px !important; /* Większa min-width dla lepszej czytelności */
    width: auto !important; /* Auto width zamiast fixed 96px */
    flex: 1 1 auto !important; /* Elastyczna szerokość */
    font-size: 16px !important;
  }

  #dimensionsFields .quantity-input-wrapper .quantity-unit {
    margin-left: var(--spacing-sm) !important; /* 12px zamiast 6px */
    flex-shrink: 0 !important; /* Zapobiega kurczeniu się jednostki */
  }

  /* Przycisk POTWIERDŹ WYMIARY - większy odstęp od pól */
  #dimensionsFields .form-field-item--subsequent:last-child {
    margin-top: var(--spacing-md) !important; /* bliżej pól */
    margin-bottom: 0 !important;
    width: 100% !important;
  }

  /* Przycisk POTWIERDŹ WYMIARY — jak "przechodzę dalej": wycentrowany, szerszy, 1 linia */
  #dimensions-confirm-btn {
    width: 100% !important;
    max-width: 340px !important;
    margin: 12px auto 0 !important;
    padding: 14px 18px !important;
  }

  #dimensions-confirm-btn .slider-confirm-card__hint {
    white-space: nowrap !important;
  }
}

/* =============================================================================
   20. MOBILE MODALS (onboarding + generic)
   ============================================================================= */

/* =============================================================================
   20A. QUICK SCENARIO MODAL - Mobile optimization (developer mode)
   ============================================================================= */
@media (max-width: 767px) {
  /* Modal dialog - mniejszy padding i szerokość */
  .quick-scenario-dialog {
    max-width: 95% !important; /* Większa szerokość na mobile */
    width: 95% !important;
    padding: var(--spacing-md) var(--spacing-sm) var(--spacing-md) !important; /* 16px 12px 16px - mniejszy padding */
    max-height: 90vh !important; /* Maksymalna wysokość viewport */
    overflow-y: auto !important;
  }

  /* Tytuł - mniejszy font */
  .quick-scenario-dialog h3 {
    font-size: 16px !important; /* Zmniejszone z 20px */
    margin-bottom: 4px !important; /* Zmniejszone z 6px */
    line-height: 1.3 !important;
  }

  /* Subtitle - mniejszy font */
  .quick-scenario-subtitle {
    font-size: 11px !important; /* Zmniejszone z 13px */
    margin-bottom: var(--spacing-sm) !important; /* 12px zamiast 16px */
    line-height: 1.4 !important;
  }

  /* Kontener pól - mniejszy max-height */
  .quick-scenario-fields {
    max-height: calc(90vh - 180px) !important; /* Dynamiczna wysokość */
    padding-right: 2px !important; /* Zmniejszone z 4px */
    margin-right: -2px !important;
  }

  /* Wiersz pola - kompaktowy layout */
  .quick-scenario-row {
    grid-template-columns: minmax(0, 1fr) minmax(0, 1fr) !important; /* Równy podział */
    column-gap: var(--spacing-xs) !important; /* 8px zamiast 16px */
    padding: 4px 0 !important; /* Zmniejszone z 6px */
    margin-bottom: var(
      --spacing-xs
    ) !important; /* 8px odstęp między wierszami */
  }

  /* Label - mniejszy font */
  .quick-scenario-label {
    font-size: 11px !important; /* Zmniejszone z 13px */
    line-height: 1.4 !important;
    word-break: break-word !important; /* Zapobiega overflow */
  }

  /* Kontrolki - mniejszy gap */
  .quick-scenario-controls {
    gap: 2px !important; /* Zmniejszone z 4px */
    justify-content: flex-end !important;
  }

  /* Przyciski +/- - mniejsze */
  .qs-btn {
    width: 24px !important; /* Zmniejszone z 28px */
    height: 24px !important;
    font-size: 14px !important; /* Zmniejszone z var(--font-size-lg) */
    min-width: 24px !important;
    flex-shrink: 0 !important;
  }

  /* Input - mniejszy */
  .qs-input {
    width: 70px !important; /* Zmniejszone z 84px */
    padding: 4px 6px !important; /* Zmniejszone padding */
    font-size: 12px !important; /* Zmniejszone z var(--font-size-sm) */
    min-width: 60px !important;
  }

  /* Select - mniejszy */
  .qs-select {
    min-width: 0 !important; /* Usuń min-width */
    width: 100% !important;
    padding: 4px 6px !important; /* Zmniejszone padding */
    font-size: 12px !important; /* Zmniejszone z var(--font-size-sm) */
  }

  /* Checkbox label - mniejszy font */
  .qs-checkbox-label span {
    font-size: 11px !important; /* Zmniejszone z var(--font-size-sm) */
    line-height: 1.4 !important;
  }

  .qs-checkbox {
    width: 16px !important; /* Zmniejszone z 18px */
    height: 16px !important;
  }

  /* Akcje - kompaktowe przyciski */
  .quick-scenario-actions {
    gap: var(--spacing-xs) !important; /* 8px zamiast 10px */
    margin-top: var(--spacing-sm) !important; /* 12px zamiast 18px */
    flex-wrap: wrap !important; /* Zawijanie na bardzo małych ekranach */
  }

  .quick-scenario-cancel,
  .quick-scenario-ok {
    min-width: 0 !important; /* Usuń min-width */
    flex: 1 1 auto !important; /* Elastyczna szerokość */
    height: 32px !important; /* Zmniejszone z 36px */
    font-size: 12px !important; /* Zmniejszone z var(--font-size-sm) */
    padding: 0 var(--spacing-xs) !important; /* 8px zamiast var(--spacing-sm) */
  }

  .quick-scenario-ok {
    min-width: 100px !important; /* Minimalna szerokość dla OK */
  }
}

@media (max-width: 767px) {
  /* Overlay: consistent padding + safe areas */
  .modal-overlay {
    padding: var(--page-pad) !important;
    padding-top: calc(var(--page-pad) + env(safe-area-inset-top)) !important;
    padding-bottom: calc(
      var(--page-pad) + env(safe-area-inset-bottom)
    ) !important;
    align-items: center !important;
  }

  /* Card: full-width, controlled height, no “desktop” proportions */
  .modal-content {
    width: 100% !important;
    max-width: calc(100vw - (var(--page-pad) * 2)) !important;
    max-height: calc(
      100svh - (var(--page-pad) * 2) - env(safe-area-inset-top) -
        env(safe-area-inset-bottom)
    ) !important;
    border-radius: var(--radius-sm) !important;
    overflow: auto !important;
    -webkit-overflow-scrolling: touch;
  }

  .modal-content.onboarding-modal--simple {
    max-width: calc(100vw - (var(--page-pad) * 2)) !important;
  }

  /* Close button: proper touch target */
  .modal-close {
    top: 10px !important;
    right: 10px !important;
    width: 44px !important;
    height: 44px !important;
    display: grid !important;
    place-items: center !important;
    padding: 0 !important;
    border-radius: var(--radius-sm) !important;
  }

  /* Onboarding spacing: 48px → mobile rhythm */
  .onboarding-header {
    padding: 26px 20px 16px !important;
  }

  .onboarding-modal--simple .onboarding-header {
    padding: 26px 20px 12px !important;
  }

  .onboarding-icon {
    width: 64px !important;
    height: 64px !important;
    margin: 0 auto 16px !important;
    font-size: 30px !important;
    box-shadow: 0 4px 12px rgba(212, 165, 116, 0.18),
      0 0 0 6px rgba(212, 165, 116, 0.05) !important;
  }

  .onboarding-header h2 {
    font-size: 22px !important;
    line-height: 1.2 !important;
    margin: 0 0 8px !important;
  }

  .onboarding-subtitle {
    font-size: 14px !important;
    line-height: 1.5 !important;
  }

  .onboarding-steps {
    padding: 18px 20px !important;
    gap: 14px !important;
  }

  .onboarding-step {
    gap: 12px !important;
  }

  .step-number {
    width: 34px !important;
    height: 34px !important;
    font-size: 15px !important;
  }

  .step-content h3 {
    font-size: 15px !important;
    margin: 0 0 4px !important;
  }

  .step-content p {
    font-size: 13px !important;
    margin: 0 !important;
  }

  .onboarding-features {
    padding: 14px 20px !important;
    gap: 12px !important;
    flex-wrap: wrap !important;
    justify-content: flex-start !important;
  }

  .feature-item {
    font-size: 13px !important;
  }

  .feature-item i {
    font-size: 18px !important;
  }

  .onboarding-actions {
    padding: 16px 20px 20px !important;
    gap: 10px !important;
  }

  .onboarding-modal--simple .onboarding-actions {
    padding: 16px 20px 26px !important;
  }

  /* Buttons inside modal */
  .btn-xl,
  .btn-large {
    width: 100% !important;
    height: 52px !important;
    font-size: 15px !important;
    border-radius: var(--radius-sm) !important;
  }

  .btn-text {
    width: 100% !important;
    padding: 10px 12px !important;
    text-align: center !important;
  }

  .onboarding-checkbox {
    padding: 0 20px 16px !important;
    justify-content: flex-start !important;
  }
}

/* =============================================================================
   21. TABLET BREAKPOINT (768-1023px)
   Prevents desktop 1300px container overflow on iPad portrait
   Based on: MOBILE_ANALYSIS_REPORT.md section 8.3 K (NICE-TO-HAVE → MUST for 768px DONE criteria)
   ============================================================================= */

@media (min-width: 768px) and (max-width: 1023px) {
  /* Apply similar anti-overflow as mobile, but keep 2-column grid where appropriate */

  /* A) Section container – prevent 1300px overflow */
  .section {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    padding: 32px clamp(24px, 4vw, 48px) !important; /* responsive padding */
  }

  /* B) Form containers */
  .formularz-z-mapa {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    /* Keep row layout on tablet (desktop-like), but ensure no overflow */
    flex-direction: row !important;
    gap: 24px !important;
  }

  .formularz {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* C) Form row mosaic – keep 2-column grid on tablet */
  .form-row-mosaic {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    /* Keep desktop grid (2 cols), but ensure container doesn't overflow */
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 24px !important;
  }

  /* D) Form card */
  .form-card {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    border: none !important; /* Flat design - no border */
    box-shadow: none !important; /* Flat design - no shadow */
    background: transparent !important; /* Merged with section */
    border-radius: 0 !important; /* Flat design - no radius */
  }

  /* E) Form field */
  .form-field {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* F) Form field item */
  .form-field-item {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* G) Form labels */
  .form-label {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* H) Building type cards container */
  .building-type-cards {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    display: grid !important;
    grid-template-columns: repeat(
      3,
      1fr
    ) !important; /* 3 kolumny na tablet zamiast 4 */
    gap: 20px !important;
    margin: 24px 0 20px !important; /* no horizontal margin - parent has padding */
    padding: 0 !important;
  }

  .building-type-card {
    min-height: 140px !important;
    padding: 12px 8px !important;
  }

  .building-type-card__label {
    font-size: 14px !important;
    line-height: 1.35 !important;
    margin-bottom: 12px !important;
  }

  /* I) Construction year wrapper */
  .construction-year-wrapper {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* J) Form select */
  select,
  .form-select,
  #construction_year {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* K) Radio group */
  .form-field__radio-group {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* L) Radio labels */
  .form-field__radio-label {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* M) Help boxes - lepszy padding na tablet */
  .help-box {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    margin-left: 0 !important; /* ✅ FIXED: Pełna szerokość bez przesunięcia */
    margin-right: 0 !important;
    margin-top: 6px !important; /* UJEDNOLICONE: 6px góra */
    margin-bottom: 0px !important; /* UJEDNOLICONE: 0px dół */
    padding: 24px var(--content-pad) !important; /* Consistent padding */
  }

  /* Help-box w form-row-mosaic - dodatkowe zabezpieczenie */
  .form-row-mosaic .help-box {
    margin-left: 0 !important;
    margin-right: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
  }

  .help-box h4,
  .help-box h3 {
    font-size: 17px !important;
  }

  .help-box p {
    font-size: 15px !important;
    line-height: 1.6 !important;
  }

  /* N) Help box content */
  .help-box h4,
  .help-box h3,
  .help-box p,
  .help-box ul,
  .help-box ol {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
  }

  .help-box img,
  .help-box .zone-map {
    width: 100% !important;
    max-width: 100% !important;
    height: auto !important;
  }

  /* O) Input fields */
  input[type="text"],
  input[type="email"],
  input[type="tel"],
  input[type="number"],
  textarea {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* P) Results wrapper */
  .results-wrapper {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    padding: 0 32px !important;
  }

  /* Q) Custom sliders */
  .custom-slider-small,
  .custom-slider-large,
  .slider-container {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* R) Yes/No cards - 2 kolumny side-by-side na tablet */
  .yes-no-cards {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 16px !important;
    margin: 0 !important; /* no margin - parent has padding */
  }

  .yes-no-card {
    min-height: 60px !important;
    padding: 16px 20px !important;
    font-size: 16px !important;
  }

  /* S) Option cards - lepszy spacing na tablet */
  .option-card {
    min-height: 72px !important;
    padding: 20px 24px !important;
  }

  .option-card__title {
    font-size: 16px !important;
  }

  .option-card__subtitle {
    font-size: 14px !important;
  }

  /* R) Brand content - dodatkowe optymalizacje dla bardzo małych ekranów */
  .brand-content {
    width: 100% !important;
    max-width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: var(--content-pad) !important;
    padding-right: var(--content-pad) !important;
  }

  .brand-content .brand-logo {
    max-width: 100px !important; /* Jeszcze mniejszy na bardzo małych ekranach */
  }

  /* S) Button row */
  .btn-row {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* T) Flex/Grid children min-width fix */
  .formularz-z-mapa > *,
  .form-row-mosaic > *,
  .form-field > *,
  .form-field-item > *,
  .form-field__radio-group > * {
    min-width: 0 !important;
  }

  /* U) Box-sizing */
  .section,
  .section *,
  .formularz,
  .formularz *,
  .form-card,
  .form-card *,
  .form-field,
  .form-field *,
  .help-box,
  .help-box * {
    box-sizing: border-box !important;
  }
}

/* =============================================================================
   21b. SMALL TABLET SUB-BREAKPOINT (768-900px)
   Extra refinement for smaller tablets like iPad Mini portrait
   ============================================================================= */

@media (min-width: 768px) and (max-width: 900px) {
  /* Building type cards - 2 kolumny dla małych tabletów zamiast 3 */
  .building-type-cards {
    grid-template-columns: 1fr 1fr !important;
    gap: 18px !important;
    margin: 20px 0 !important; /* no horizontal margin - parent has padding */
  }

  .building-type-card {
    min-height: 150px !important;
    padding: 14px 10px !important;
  }

  .building-type-card__label {
    font-size: 15px !important;
    margin-bottom: 12px !important;
  }

  /* Help box */
  .help-box {
    margin-top: 6px !important; /* UJEDNOLICONE: 6px góra */
    margin-bottom: 0px !important; /* UJEDNOLICONE: 0px dół */
    padding: 20px !important;
  }

  /* Yes/No cards spacing */
  .yes-no-cards {
    gap: 14px !important;
  }
}

/* =============================================================================
   22. EXTRA SMALL MOBILE SUB-BREAKPOINT (max 480px)
   Micro-adjustments for small phones
   ============================================================================= */

@media (max-width: 480px) {
  /* Building type cards - reduce gap and padding for small screens */
  .building-type-cards {
    gap: 12px !important;
    margin: 16px 0 14px !important; /* no horizontal margin - parent has padding */
  }

  .building-type-card {
    min-height: 120px !important;
    padding: 10px 6px !important;
  }

  .building-type-card__icon img {
    width: 70px !important;
    height: 70px !important;
  }

  .building-type-card__label {
    font-size: 13px !important;
    line-height: 1.3 !important;
    margin-bottom: 12px !important;
  }

  /* Yes/No cards - full stacking */
  .yes-no-card {
    min-height: 52px !important;
    padding: 16px 18px !important;
    font-size: 15px !important;
  }

  /* Help box - tighter spacing */
  .help-box {
    margin-top: 6px !important; /* UJEDNOLICONE: 6px góra */
    margin-bottom: 0px !important; /* UJEDNOLICONE: 0px dół */
  }

  .help-box--always-open {
    padding: 18px 14px !important;
  }

  /* Reduce content-pad globally for small screens */
  :root {
    --content-pad: 12px;
  }
}

/* =============================================================================
   22b. MOBILE PREMIUM FORM LAYOUT (sections + option cards)
   ============================================================================= */
@media (max-width: 767px) {
  :root {
    --page-pad: 16px;
    --content-pad: 16px;
  }

  #top-instal-calc {
    background: #f6f7f9;
    padding: 0 var(--page-pad) 24px;
  }

  #top-instal-calc .section {
    background: transparent;
    padding: 0;
  }

  #top-instal-calc .form-card {
    background: transparent !important; /* Flat design - merged with section */
    border: none !important; /* No border */
    border-radius: 0 !important; /* No radius - flat */
    padding: 16px 16px 18px;
    box-shadow: none !important; /* No shadow - flat design */
    margin: 0 0 20px;
  }

  #top-instal-calc .form-field-item {
    margin-bottom: 16px;
  }

  #top-instal-calc .form-label {
    font-size: 15px;
    line-height: 1.4;
    letter-spacing: -0.01em;
    text-transform: none;
    font-weight: 600;
    margin-bottom: 8px;
  }

  #top-instal-calc .form-label::before {
    display: none !important;
  }

  /* Option lists as touch-friendly rows */
  .option-cards {
    background: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    padding: 6px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .option-cards.option-cards--compact {
    gap: 8px;
    padding: 6px;
  }

  .option-card {
    width: 100%;
    min-height: 56px;
    padding: 14px 14px;
    border-radius: 10px;
    border: 1px solid transparent;
    background: transparent;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    text-align: left;
    transition: border-color 0.18s ease, background-color 0.18s ease,
      box-shadow 0.18s ease;
  }

  .option-card::after {
    content: "";
    width: 20px;
    height: 20px;
    border: 2px solid #d1d5db;
    border-radius: 50%;
    flex-shrink: 0;
    box-sizing: border-box;
  }

  .option-card__title {
    font-size: 17px !important;
    line-height: 1.25 !important;
    font-weight: 700 !important;
    text-transform: none;
  }

  .option-card__subtitle {
    font-size: 13px !important;
    line-height: 1.4 !important;
    color: #6b7280 !important;
    text-transform: none;
  }

  /* FIX: na końcu pliku była druga definicja mobile option-cardów (pozioma, space-between),
     która spychała subtytuły i psuła layout. Na mobile chcemy title+subtitle w kolumnie. */
  .option-card {
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    text-align: center !important;
    gap: 6px !important;
  }

  /* FIX: całkowicie wyłącz pseudo-radio „kółka” w option-cardach na mobile */
  .option-card::after,
  .option-card--selected::after {
    content: none !important;
    display: none !important;
  }

  .option-card--selected {
    background: linear-gradient(
      135deg,
      rgba(212, 165, 116, 0.12),
      rgba(212, 165, 116, 0.06)
    );
    border-color: #d4a574;
    box-shadow: 0 2px 4px rgba(212, 165, 116, 0.08); /* FIXED: was 6px/18px (too heavy) */
  }

  .option-card--selected::after {
    border-color: #d4a574;
    background: #d4a574
      url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='%23fff' d='M6.6 11.2 3.4 8l1.2-1.2 2 2 4-4L11.8 6l-4.2 5.2z'/%3e%3c/svg%3e")
      center/12px 12px no-repeat;
    box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.16);
  }

  .option-card:active {
    background: #f1f5f9;
  }

  /* Compact section headers */
  .section-title {
    font-size: 18px !important;
    line-height: 1.3 !important;
    margin-bottom: 4px !important;
    text-transform: none;
  }

  .section-description {
    font-size: 14px !important;
    line-height: 1.6 !important;
    margin-bottom: 12px !important;
  }
}

/* =============================================================================
   23. ACCESSIBILITY: PREFERS-REDUCED-MOTION (WCAG 2.1 Level AA)
   ============================================================================= */

@media (max-width: 767px) and (prefers-reduced-motion: reduce) {
  /* Global: Disable all animations and transitions */
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  /* Section fade-in animation → disabled */
  .section.active {
    animation: none !important;
  }

  /* REMOVED: Help toggle icon (accordion removed) */

  /* Card select animation → disabled */
  .option-card--selected {
    animation: none !important;
  }

  /* Toast slide-up → instant */
  .toast-mobile {
    animation: none !important;
  }

  /* Active state scale transforms → disabled */
  .building-type-card:active,
  .yes-no-card:active,
  .option-card:active,
  .btn-step:active,
  button:active {
    transform: none !important;
  }

  /* Loading spinner → disabled */
  .spinner-mobile {
    animation: none !important;
  }
}

/* =============================================================================
   24. MOBILE PRINT STYLES
   ============================================================================= */

@media print {
  .progress-bar-container,
  .bottom-nav-mobile,
  .configurator-selections-bar,
  .toast-mobile {
    display: none !important;
  }
  /* REMOVED: .help-toggle (accordion removed) */
}

/* =============================================================================
   24. ACCESSIBILITY: PREFERS-REDUCED-MOTION
   ============================================================================= */

/**
 * WCAG 2.1 Level AA Compliance: Respect user's motion preferences
 * Users with vestibular disorders can disable animations system-wide
 * Source: UI UX Pro Max audit recommendation (HIGH priority)
 */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  /* Disable transform animations specifically */
  .section.active,
  .option-card--selected,
  .building-type-card:active,
  .yes-no-card:active,
  .option-card:active,
  .toast-mobile,
  .loading-overlay-mobile {
    animation: none !important;
    transition: none !important;
  }

  /* Keep functional transitions (color/opacity) but instant */
  input:focus,
  select:focus,
  textarea:focus,
  button:hover,
  .btn:hover {
    transition: border-color 0.01ms, background-color 0.01ms !important;
  }
}

/* =============================================================================
   25. FULL-BLEED MOBILE: usuwa boczne paski/guttery z WordPress/Elementora
   ============================================================================= */

@media (max-width: 767px) {
  :root {
    --hp-mobile-gutter: 15px; /* jak trzeba: 10px lub 20px */
  }

  /* 1) Twój root kalkulatora ma być na 100% szerokości */
  .heatpump-calculator {
    width: 100% !important;
    max-width: none !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
    overflow-x: hidden;
  }

  /* 2) Jeśli Elementor/Theme daje padding rodzica – kompensujemy go ujemnym marginesem */
  .elementor-widget-shortcode .heatpump-calculator,
  .elementor-widget-html .heatpump-calculator,
  .elementor-widget-text-editor .heatpump-calculator {
    margin-left: calc(-1 * var(--hp-mobile-gutter)) !important;
    margin-right: calc(-1 * var(--hp-mobile-gutter)) !important;
    width: calc(
      100% + var(--hp-mobile-gutter) + var(--hp-mobile-gutter)
    ) !important;
  }

  /* 3) Bezpiecznik na przypadkowy poziomy scroll */
  .heatpump-calculator-wrapper {
    overflow-x: hidden;
  }
}

/* P0 CLICK FIX: zapewnia, że elementy kalkulatora będą odbierać kliknięcia nawet
   jeśli na stronie są globalne pseudo-elementy/overlays (np. Elementor) */
.heatpump-calculator {
  position: relative;
  isolation: isolate;
}

.heatpump-calculator button,
.heatpump-calculator [role="button"],
.heatpump-calculator input[type="submit"] {
  pointer-events: auto !important;
  position: relative;
  z-index: 10;
}

/* Kill overlays (pseudo-elements) */
.heatpump-calculator ::before,
.heatpump-calculator ::after {
  pointer-events: none !important;
}

/* =============================================================================
   25. KOMPLEKSOWE OPTYMALIZACJE SPACING - UJEDNOLICENIE WSZYSTKICH ELEMENTÓW
   Dodatkowe optymalizacje dla wszystkich elementów formularza w widoku mobilnym
   ============================================================================= */

@media (max-width: 767px) {
  /* ============================================
     RADIO BUTTONS - Kompaktowe odstępy
     ============================================ */
  .form-field__radio-group {
    gap: 10px !important; /* Zmniejszone z 12px - bardziej kompaktowe */
    margin-top: 2px !important; /* Zmniejszone z 4px - bliżej labela */
  }

  .form-field__radio-label {
    margin-bottom: 0 !important; /* Usunięcie dodatkowego margin-bottom */
  }

  /* ============================================
     CHECKBOXY - Kompaktowe odstępy
     ============================================ */
  .form-field-item input[type="checkbox"] + label,
  .form-field-item label:has(input[type="checkbox"]) {
    margin-bottom: 0 !important;
  }

  /* ============================================
     SLIDERY - Kompaktowe odstępy
     ============================================ */
  .custom-slider-container {
    margin-top: 16px !important; /* Zmniejszone z 24px */
    padding-top: 40px !important; /* Zmniejszone z 44px */
    padding-bottom: 12px !important; /* Zmniejszone z 16px */
    margin-bottom: 16px !important; /* Zmniejszone z var(--spacing-lg) */
    gap: 12px !important; /* Zmniejszone z 16px */
  }

  /* ============================================
     NUMBER INPUT WRAPPER - Kompaktowe odstępy
     ============================================ */
  .number-input-wrapper {
    margin-top: 2px !important; /* Minimalny odstęp od labela */
    margin-bottom: 16px !important; /* Standardowy odstęp na dole */
    gap: 10px !important; /* Zmniejszone z 12px */
  }

  /* ============================================
     SELECT/DROPDOWN - Kompaktowe odstępy
     ============================================ */
  select,
  .form-select {
    margin-top: 2px !important; /* Minimalny odstęp od labela */
    margin-bottom: 16px !important; /* Standardowy odstęp na dole */
  }

  /* ============================================
     TEXT INPUTS - Kompaktowe odstępy
     ============================================ */
  input[type="text"],
  input[type="email"],
  input[type="tel"],
  input[type="number"]:not(.number-input-wrapper input),
  textarea {
    margin-top: 2px !important; /* Minimalny odstęp od labela */
    margin-bottom: 16px !important; /* Standardowy odstęp na dole */
  }

  /* ============================================
     BUILDING TYPE CARDS - Kompaktowe odstępy
     ============================================ */
  .building-type-cards {
    gap: 12px !important; /* Zmniejszone z 16px */
    margin-top: 2px !important; /* Minimalny odstęp od labela */
    margin-bottom: 16px !important; /* Standardowy odstęp na dole */
  }

  .building-type-card {
    margin-bottom: 0 !important; /* Gap kontroluje spacing */
  }

  /* ============================================
     YES/NO CARDS - Kompaktowe odstępy
     ============================================ */
  .yes-no-cards {
    gap: 12px !important; /* Zmniejszone z 14px */
    margin-top: 2px !important; /* Minimalny odstęp od labela */
    margin-bottom: 16px !important; /* Standardowy odstęp na dole */
  }

  .yes-no-card {
    margin-bottom: 0 !important; /* Gap kontroluje spacing */
  }

  /* ============================================
     FORM FIELD ITEMS - Kompaktowe odstępy
     ============================================ */
  .form-field-item {
    margin-bottom: 16px !important; /* Ujednolicony odstęp między polami */
  }

  .form-field-item:last-child {
    margin-bottom: 0 !important; /* Ostatni element bez margin-bottom */
  }

  /* ============================================
     FORM FIELDS - Kompaktowe odstępy
     ============================================ */
  .form-field {
    margin-bottom: 20px !important; /* Ujednolicony odstęp między sekcjami pól */
  }

  .form-field:last-child {
    margin-bottom: 0 !important;
  }

  /* ============================================
     PROGRESS BAR - Kompaktowe odstępy
     ============================================ */
  .form-progress {
    margin-top: 12px !important; /* Zmniejszone z 20px */
    margin-bottom: 12px !important; /* Ujednolicony odstęp */
  }

  .progress-info-row {
    margin-top: 4px !important;
    margin-bottom: 20px !important; /* Zmniejszone z 48px */
  }

  /* ============================================
     SEKCJE Z OPISAMI - Kompaktowe odstępy
     ============================================ */
  .section-title,
  h2,
  h3 {
    margin-bottom: 2px !important; /* Minimalny odstęp pod tytułem */
  }

  /* Ukryj nagłówek "DOCIEPLENIE ŚCIAN:" (tylko nagłówek) – na mobile jest redundantny */
  .section[data-tab="2"] > h3:nth-of-type(2) {
    display: none !important;
  }

  .section-description,
  .step-description,
  p:not(.help-box p):not(.field-note) {
    margin-top: 0 !important;
    margin-bottom: 16px !important; /* Standardowy odstęp na dole */
  }

  /* ============================================
     FIELD NOTES - Kompaktowe odstępy
     ============================================ */
  .field-note,
  .micro-note,
  small {
    margin-top: 4px !important; /* Zmniejszone z 8px - bliżej pola */
    margin-bottom: 0 !important;
  }

  /* ============================================
     BUTTON ROW - Kompaktowe odstępy
     ============================================ */
  .btn-row {
    margin-top: 20px !important;
    margin-bottom: 0 !important;
    gap: 12px !important; /* Zmniejszone z 16px */
  }

  /* ============================================
     OPTION CARDS - Kompaktowe odstępy
     ============================================ */
  .option-cards {
    gap: 12px !important;
    margin-top: 2px !important;
    margin-bottom: 16px !important;
  }

  /* ============================================
     FORM ROW MOSAIC - Kompaktowe odstępy
     ============================================ */
  .form-row-mosaic {
    gap: 16px !important; /* Ujednolicony gap */
    margin-bottom: 20px !important; /* Ujednolicony margin-bottom */
  }

  /* ============================================
     FORM CARD - Kompaktowe odstępy
     ============================================ */
  .form-card {
    margin-bottom: 24px !important; /* Zmniejszone z 32px */
    padding-top: 20px !important; /* Zmniejszone z 24px */
    padding-bottom: 20px !important; /* Zmniejszone z 24px */
  }

  /* ============================================
     SLIDER CONFIRM CARD - Kompaktowe odstępy
     ============================================ */
  .slider-confirm-card {
    margin-top: 8px !important; /* Zmniejszone z 4px - więcej przestrzeni */
    margin-bottom: 0 !important;
  }
}

/* =============================================================================
   END OF MOBILE REDESIGN CSS
   ============================================================================= */
